[2025-06-05 15:36:02] DEBUG: Database connection established 
[2025-06-05 15:36:02] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":41.81,"rows_affected":0}
[2025-06-05 15:36:02] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":42.06,"rows_affected":0}
[2025-06-05 15:36:02] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":41.18,"rows_affected":1}
[2025-06-05 15:37:08] DEBUG: Database connection established 
[2025-06-05 15:37:08] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":42.4,"rows_affected":0}
[2025-06-05 15:37:08] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":39.85,"rows_affected":0}
[2025-06-05 15:37:08] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":41.21,"rows_affected":1}
[2025-06-05 15:42:09] DEBUG: Database connection established 
[2025-06-05 15:42:09] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":41.87,"rows_affected":0}
[2025-06-05 15:42:09] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":39.51,"rows_affected":0}
[2025-06-05 15:42:09] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":40.23,"rows_affected":1}
[2025-06-05 15:47:11] DEBUG: Database connection established 
[2025-06-05 15:47:11] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":45.16,"rows_affected":0}
[2025-06-05 15:47:11] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":40,"rows_affected":0}
[2025-06-05 15:47:11] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":40.39,"rows_affected":1}
[2025-06-05 15:52:13] DEBUG: Database connection established 
[2025-06-05 15:52:13] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":45.7,"rows_affected":0}
[2025-06-05 15:52:13] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":39.9,"rows_affected":0}
[2025-06-05 15:52:13] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":40.57,"rows_affected":1}
[2025-06-05 15:57:14] DEBUG: Database connection established 
[2025-06-05 15:57:14] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.18,"rows_affected":0}
[2025-06-05 15:57:14] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.14,"rows_affected":0}
[2025-06-05 15:57:14] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.9,"rows_affected":1}
[2025-06-05 16:02:15] DEBUG: Database connection established 
[2025-06-05 16:02:15] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":35.95,"rows_affected":0}
[2025-06-05 16:02:15] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.22,"rows_affected":0}
[2025-06-05 16:02:15] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":33.06,"rows_affected":1}
[2025-06-05 16:07:18] DEBUG: Database connection established 
[2025-06-05 16:07:18] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.05,"rows_affected":0}
[2025-06-05 16:07:18] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.73,"rows_affected":0}
[2025-06-05 16:07:18] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.82,"rows_affected":1}
[2025-06-05 16:12:19] DEBUG: Database connection established 
[2025-06-05 16:12:19] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":36.04,"rows_affected":0}
[2025-06-05 16:12:19] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.09,"rows_affected":0}
[2025-06-05 16:12:19] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.25,"rows_affected":1}
[2025-06-05 16:17:21] DEBUG: Database connection established 
[2025-06-05 16:17:21] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":36.54,"rows_affected":0}
[2025-06-05 16:17:21] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.85,"rows_affected":0}
[2025-06-05 16:17:21] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.45,"rows_affected":1}
[2025-06-05 16:22:23] DEBUG: Database connection established 
[2025-06-05 16:22:23] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.44,"rows_affected":0}
[2025-06-05 16:22:23] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.03,"rows_affected":0}
[2025-06-05 16:22:23] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":33.25,"rows_affected":1}
[2025-06-05 16:27:25] DEBUG: Database connection established 
[2025-06-05 16:27:25] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":35.13,"rows_affected":0}
[2025-06-05 16:27:25] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.8,"rows_affected":0}
[2025-06-05 16:27:25] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.4,"rows_affected":1}
[2025-06-05 16:32:27] DEBUG: Database connection established 
[2025-06-05 16:32:27] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":33.99,"rows_affected":0}
[2025-06-05 16:32:27] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.8,"rows_affected":0}
[2025-06-05 16:32:27] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.9,"rows_affected":1}
[2025-06-05 16:37:29] DEBUG: Database connection established 
[2025-06-05 16:37:29] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.75,"rows_affected":0}
[2025-06-05 16:37:30] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.16,"rows_affected":0}
[2025-06-05 16:37:30] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.79,"rows_affected":1}
[2025-06-05 16:42:31] DEBUG: Database connection established 
[2025-06-05 16:42:31] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":33.89,"rows_affected":0}
[2025-06-05 16:42:31] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.16,"rows_affected":0}
[2025-06-05 16:42:31] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":33.32,"rows_affected":1}
[2025-06-05 16:47:33] DEBUG: Database connection established 
[2025-06-05 16:47:33] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.32,"rows_affected":0}
[2025-06-05 16:47:33] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32,"rows_affected":0}
[2025-06-05 16:47:33] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":33,"rows_affected":1}
[2025-06-05 16:52:35] DEBUG: Database connection established 
[2025-06-05 16:52:35] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":35.89,"rows_affected":0}
[2025-06-05 16:52:35] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.89,"rows_affected":0}
[2025-06-05 16:52:35] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":33.05,"rows_affected":1}
[2025-06-05 16:57:37] DEBUG: Database connection established 
[2025-06-05 16:57:37] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.34,"rows_affected":0}
[2025-06-05 16:57:37] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.19,"rows_affected":0}
[2025-06-05 16:57:37] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":33.82,"rows_affected":1}
[2025-06-05 17:02:39] DEBUG: Database connection established 
[2025-06-05 17:02:39] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.13,"rows_affected":0}
[2025-06-05 17:02:39] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.1,"rows_affected":0}
[2025-06-05 17:02:39] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.87,"rows_affected":1}
[2025-06-05 17:07:41] DEBUG: Database connection established 
[2025-06-05 17:07:41] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":35.67,"rows_affected":0}
[2025-06-05 17:07:41] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.92,"rows_affected":0}
[2025-06-05 17:07:41] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.91,"rows_affected":1}
[2025-06-05 17:12:42] DEBUG: Database connection established 
[2025-06-05 17:12:42] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":33.43,"rows_affected":0}
[2025-06-05 17:12:42] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.06,"rows_affected":0}
[2025-06-05 17:12:42] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.61,"rows_affected":1}
[2025-06-05 17:17:44] DEBUG: Database connection established 
[2025-06-05 17:17:44] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":33.29,"rows_affected":0}
[2025-06-05 17:17:44] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":30.84,"rows_affected":0}
[2025-06-05 17:17:44] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":31.45,"rows_affected":1}
[2025-06-05 17:22:49] DEBUG: Database connection established 
[2025-06-05 17:22:49] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":462.21,"rows_affected":0}
[2025-06-05 17:22:50] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":478.18,"rows_affected":0}
[2025-06-05 17:22:50] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":170.96,"rows_affected":1}
[2025-06-05 17:27:51] DEBUG: Database connection established 
[2025-06-05 17:27:51] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.26,"rows_affected":0}
[2025-06-05 17:27:51] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":30.58,"rows_affected":0}
[2025-06-05 17:27:51] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":31.32,"rows_affected":1}
[2025-06-05 17:32:54] DEBUG: Database connection established 
[2025-06-05 17:32:54] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":34.14,"rows_affected":0}
[2025-06-05 17:32:54] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":31.37,"rows_affected":0}
[2025-06-05 17:32:54] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":31.26,"rows_affected":1}
[2025-06-05 17:37:56] DEBUG: Database connection established 
[2025-06-05 17:37:56] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":36.4,"rows_affected":0}
[2025-06-05 17:37:56] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":32.06,"rows_affected":0}
[2025-06-05 17:37:56] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.17,"rows_affected":1}
[2025-06-05 17:42:58] DEBUG: Database connection established 
[2025-06-05 17:42:58] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":33.81,"rows_affected":0}
[2025-06-05 17:42:58] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":30.79,"rows_affected":0}
[2025-06-05 17:42:59] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":32.11,"rows_affected":1}
[2025-06-05 17:48:00] DEBUG: Database connection established 
[2025-06-05 17:48:00] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.34,"rows_affected":0}
[2025-06-05 17:48:00] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.63,"rows_affected":0}
[2025-06-05 17:48:00] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.16,"rows_affected":1}
[2025-06-05 17:53:02] DEBUG: Database connection established 
[2025-06-05 17:53:02] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":50.13,"rows_affected":0}
[2025-06-05 17:53:02] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.94,"rows_affected":0}
[2025-06-05 17:53:02] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.72,"rows_affected":1}
[2025-06-05 17:58:05] DEBUG: Database connection established 
[2025-06-05 17:58:05] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.84,"rows_affected":0}
[2025-06-05 17:58:05] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.85,"rows_affected":0}
[2025-06-05 17:58:05] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.08,"rows_affected":1}
[2025-06-05 18:03:07] DEBUG: Database connection established 
[2025-06-05 18:03:07] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":46.94,"rows_affected":0}
[2025-06-05 18:03:08] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.45,"rows_affected":0}
[2025-06-05 18:03:08] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.59,"rows_affected":1}
[2025-06-05 18:08:09] DEBUG: Database connection established 
[2025-06-05 18:08:09] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.51,"rows_affected":0}
[2025-06-05 18:08:09] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.03,"rows_affected":0}
[2025-06-05 18:08:09] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.77,"rows_affected":1}
[2025-06-05 18:13:12] DEBUG: Database connection established 
[2025-06-05 18:13:12] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":50.71,"rows_affected":0}
[2025-06-05 18:13:12] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.94,"rows_affected":0}
[2025-06-05 18:13:12] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.55,"rows_affected":1}
[2025-06-05 18:18:15] DEBUG: Database connection established 
[2025-06-05 18:18:15] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":45.91,"rows_affected":0}
[2025-06-05 18:18:15] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.65,"rows_affected":0}
[2025-06-05 18:18:15] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.08,"rows_affected":1}
[2025-06-05 18:23:18] DEBUG: Database connection established 
[2025-06-05 18:23:18] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.77,"rows_affected":0}
[2025-06-05 18:23:18] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.75,"rows_affected":0}
[2025-06-05 18:23:18] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.56,"rows_affected":1}
[2025-06-05 18:28:21] DEBUG: Database connection established 
[2025-06-05 18:28:21] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.04,"rows_affected":0}
[2025-06-05 18:28:21] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.66,"rows_affected":0}
[2025-06-05 18:28:22] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.65,"rows_affected":1}
[2025-06-05 18:33:23] DEBUG: Database connection established 
[2025-06-05 18:33:23] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":46.54,"rows_affected":0}
[2025-06-05 18:33:23] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.66,"rows_affected":0}
[2025-06-05 18:33:24] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.67,"rows_affected":1}
[2025-06-05 18:38:26] DEBUG: Database connection established 
[2025-06-05 18:38:26] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.31,"rows_affected":0}
[2025-06-05 18:38:26] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.71,"rows_affected":0}
[2025-06-05 18:38:26] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.69,"rows_affected":1}
[2025-06-05 18:43:29] DEBUG: Database connection established 
[2025-06-05 18:43:29] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.08,"rows_affected":0}
[2025-06-05 18:43:29] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.59,"rows_affected":0}
[2025-06-05 18:43:29] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.64,"rows_affected":1}
[2025-06-05 18:48:31] DEBUG: Database connection established 
[2025-06-05 18:48:31] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.83,"rows_affected":0}
[2025-06-05 18:48:32] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.82,"rows_affected":0}
[2025-06-05 18:48:32] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.41,"rows_affected":1}
[2025-06-05 18:53:34] DEBUG: Database connection established 
[2025-06-05 18:53:34] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.1,"rows_affected":0}
[2025-06-05 18:53:34] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.96,"rows_affected":0}
[2025-06-05 18:53:34] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.45,"rows_affected":1}
[2025-06-05 18:58:38] DEBUG: Database connection established 
[2025-06-05 18:58:38] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":51.36,"rows_affected":0}
[2025-06-05 18:58:38] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.35,"rows_affected":0}
[2025-06-05 18:58:38] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":46.38,"rows_affected":1}
[2025-06-05 19:03:41] DEBUG: Database connection established 
[2025-06-05 19:03:41] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":51.54,"rows_affected":0}
[2025-06-05 19:03:41] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.6,"rows_affected":0}
[2025-06-05 19:03:41] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.89,"rows_affected":1}
[2025-06-05 19:08:44] DEBUG: Database connection established 
[2025-06-05 19:08:44] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.03,"rows_affected":0}
[2025-06-05 19:08:44] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.97,"rows_affected":0}
[2025-06-05 19:08:44] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.95,"rows_affected":1}
[2025-06-05 19:13:47] DEBUG: Database connection established 
[2025-06-05 19:13:47] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.39,"rows_affected":0}
[2025-06-05 19:13:47] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.79,"rows_affected":0}
[2025-06-05 19:13:47] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.13,"rows_affected":1}
[2025-06-05 19:18:50] DEBUG: Database connection established 
[2025-06-05 19:18:50] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.69,"rows_affected":0}
[2025-06-05 19:18:50] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.95,"rows_affected":0}
[2025-06-05 19:18:50] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.92,"rows_affected":1}
[2025-06-05 19:23:53] DEBUG: Database connection established 
[2025-06-05 19:23:53] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.41,"rows_affected":0}
[2025-06-05 19:23:53] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.97,"rows_affected":0}
[2025-06-05 19:23:53] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.69,"rows_affected":1}
[2025-06-05 19:28:56] DEBUG: Database connection established 
[2025-06-05 19:28:56] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.54,"rows_affected":0}
[2025-06-05 19:28:56] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.42,"rows_affected":0}
[2025-06-05 19:28:56] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.52,"rows_affected":1}
[2025-06-05 19:34:00] DEBUG: Database connection established 
[2025-06-05 19:34:00] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.98,"rows_affected":0}
[2025-06-05 19:34:00] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.4,"rows_affected":0}
[2025-06-05 19:34:00] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.51,"rows_affected":1}
[2025-06-05 19:39:03] DEBUG: Database connection established 
[2025-06-05 19:39:03] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":53.93,"rows_affected":0}
[2025-06-05 19:39:04] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.04,"rows_affected":0}
[2025-06-05 19:39:04] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.72,"rows_affected":1}
[2025-06-05 19:44:08] DEBUG: Database connection established 
[2025-06-05 19:44:08] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.49,"rows_affected":0}
[2025-06-05 19:44:08] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.69,"rows_affected":0}
[2025-06-05 19:44:08] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.48,"rows_affected":1}
[2025-06-05 19:49:11] DEBUG: Database connection established 
[2025-06-05 19:49:11] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.05,"rows_affected":0}
[2025-06-05 19:49:11] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.69,"rows_affected":0}
[2025-06-05 19:49:11] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.34,"rows_affected":1}
[2025-06-05 19:54:14] DEBUG: Database connection established 
[2025-06-05 19:54:14] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":54.14,"rows_affected":0}
[2025-06-05 19:54:14] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.17,"rows_affected":0}
[2025-06-05 19:54:14] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.82,"rows_affected":1}
[2025-06-05 19:59:18] DEBUG: Database connection established 
[2025-06-05 19:59:18] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.1,"rows_affected":0}
[2025-06-05 19:59:18] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.38,"rows_affected":0}
[2025-06-05 19:59:18] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.25,"rows_affected":1}
[2025-06-05 20:04:23] DEBUG: Database connection established 
[2025-06-05 20:04:23] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.27,"rows_affected":0}
[2025-06-05 20:04:24] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.36,"rows_affected":0}
[2025-06-05 20:04:24] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.96,"rows_affected":1}
[2025-06-05 20:09:26] DEBUG: Database connection established 
[2025-06-05 20:09:26] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.88,"rows_affected":0}
[2025-06-05 20:09:26] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.72,"rows_affected":0}
[2025-06-05 20:09:26] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.54,"rows_affected":1}
[2025-06-05 20:14:29] DEBUG: Database connection established 
[2025-06-05 20:14:29] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.33,"rows_affected":0}
[2025-06-05 20:14:29] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.07,"rows_affected":0}
[2025-06-05 20:14:29] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.24,"rows_affected":1}
[2025-06-05 20:19:32] DEBUG: Database connection established 
[2025-06-05 20:19:32] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.29,"rows_affected":0}
[2025-06-05 20:19:32] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.46,"rows_affected":0}
[2025-06-05 20:19:32] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.51,"rows_affected":1}
[2025-06-05 20:24:36] DEBUG: Database connection established 
[2025-06-05 20:24:36] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.99,"rows_affected":0}
[2025-06-05 20:24:36] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.06,"rows_affected":0}
[2025-06-05 20:24:36] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":44.54,"rows_affected":1}
[2025-06-05 20:29:40] DEBUG: Database connection established 
[2025-06-05 20:29:40] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":50.32,"rows_affected":0}
[2025-06-05 20:29:40] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.01,"rows_affected":0}
[2025-06-05 20:29:40] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.43,"rows_affected":1}
[2025-06-05 20:34:45] DEBUG: Database connection established 
[2025-06-05 20:34:45] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":46.85,"rows_affected":0}
[2025-06-05 20:34:45] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.64,"rows_affected":0}
[2025-06-05 20:34:45] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.26,"rows_affected":1}
[2025-06-05 20:39:47] DEBUG: Database connection established 
[2025-06-05 20:39:47] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.27,"rows_affected":0}
[2025-06-05 20:39:47] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.13,"rows_affected":0}
[2025-06-05 20:39:47] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.02,"rows_affected":1}
[2025-06-05 20:44:49] DEBUG: Database connection established 
[2025-06-05 20:44:49] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.16,"rows_affected":0}
[2025-06-05 20:44:49] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.17,"rows_affected":0}
[2025-06-05 20:44:49] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":46.2,"rows_affected":1}
[2025-06-05 20:49:51] DEBUG: Database connection established 
[2025-06-05 20:49:51] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.15,"rows_affected":0}
[2025-06-05 20:49:51] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.4,"rows_affected":0}
[2025-06-05 20:49:51] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.98,"rows_affected":1}
[2025-06-05 20:54:53] DEBUG: Database connection established 
[2025-06-05 20:54:53] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.94,"rows_affected":0}
[2025-06-05 20:54:53] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.03,"rows_affected":0}
[2025-06-05 20:54:53] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.61,"rows_affected":1}
[2025-06-05 20:59:55] DEBUG: Database connection established 
[2025-06-05 20:59:55] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":46,"rows_affected":0}
[2025-06-05 20:59:55] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.2,"rows_affected":0}
[2025-06-05 20:59:55] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":44.4,"rows_affected":1}
[2025-06-05 21:04:58] DEBUG: Database connection established 
[2025-06-05 21:04:58] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.68,"rows_affected":0}
[2025-06-05 21:04:58] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.95,"rows_affected":0}
[2025-06-05 21:04:58] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.72,"rows_affected":1}
[2025-06-05 21:10:00] DEBUG: Database connection established 
[2025-06-05 21:10:00] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.6,"rows_affected":0}
[2025-06-05 21:10:00] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.76,"rows_affected":0}
[2025-06-05 21:10:00] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.25,"rows_affected":1}
[2025-06-05 21:15:02] DEBUG: Database connection established 
[2025-06-05 21:15:02] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.23,"rows_affected":0}
[2025-06-05 21:15:02] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":49.75,"rows_affected":0}
[2025-06-05 21:15:02] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":44.81,"rows_affected":1}
[2025-06-05 21:20:04] DEBUG: Database connection established 
[2025-06-05 21:20:04] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.97,"rows_affected":0}
[2025-06-05 21:20:04] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.74,"rows_affected":0}
[2025-06-05 21:20:04] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.52,"rows_affected":1}
[2025-06-05 21:25:06] DEBUG: Database connection established 
[2025-06-05 21:25:06] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.84,"rows_affected":0}
[2025-06-05 21:25:06] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":43.87,"rows_affected":0}
[2025-06-05 21:25:06] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.23,"rows_affected":1}
[2025-06-05 21:30:08] DEBUG: Database connection established 
[2025-06-05 21:30:08] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.76,"rows_affected":0}
[2025-06-05 21:30:08] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.47,"rows_affected":0}
[2025-06-05 21:30:08] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.23,"rows_affected":1}
[2025-06-05 21:35:11] DEBUG: Database connection established 
[2025-06-05 21:35:11] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.43,"rows_affected":0}
[2025-06-05 21:35:11] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.1,"rows_affected":0}
[2025-06-05 21:35:11] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.48,"rows_affected":1}
[2025-06-05 21:40:13] DEBUG: Database connection established 
[2025-06-05 21:40:13] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.74,"rows_affected":0}
[2025-06-05 21:40:13] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.51,"rows_affected":0}
[2025-06-05 21:40:13] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":44.93,"rows_affected":1}
[2025-06-05 21:45:15] DEBUG: Database connection established 
[2025-06-05 21:45:15] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.29,"rows_affected":0}
[2025-06-05 21:45:15] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.89,"rows_affected":0}
[2025-06-05 21:45:15] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":46.01,"rows_affected":1}
[2025-06-05 21:49:54] DEBUG: Database connection established 
[2025-06-05 21:49:54] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.62,"rows_affected":0}
[2025-06-05 21:49:54] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.75,"rows_affected":0}
[2025-06-05 21:49:54] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.51,"rows_affected":1}
[2025-06-05 21:50:01] DEBUG: Database connection established 
[2025-06-05 21:50:01] DEBUG: Query executed {"sql":"INSERT INTO sync_logs (sync_type, sync_date, status, started_at) VALUES (?, ?, ?, ?)","params":["facebook","2025-06-05 21:50:01","running","2025-06-05 21:50:01"],"duration_ms":45.93,"rows_affected":1}
[2025-06-05 21:50:01] INFO: Sync started {"type":"facebook","log_id":"1"}
[2025-06-05 21:50:01] INFO: Fetching ad accounts 
[2025-06-05 21:50:02] INFO: API Call to Facebook {"endpoint":"\/me\/adaccounts","params":{"method":"GET","params":{"fields":"id,name,currency,timezone_name,timezone_offset_hours_utc,account_status,business_name,amount_spent,balance","limit":100,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":957.8,"response_size":2003}
[2025-06-05 21:50:02] INFO: Ad accounts fetched {"count":8}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_223217352222205","Javier Apaulaza","USD","America\/Montevideo",-3,1,"",null,0,0],"duration_ms":61.78,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_223217352222205","name":"Javier Apaulaza"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_368576981173158","JavierAp Add Account","USD","America\/Montevideo",-3,1,"LewAR",null,833267,0],"duration_ms":45.42,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_368576981173158","name":"JavierAp Add Account"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_741300161237395","JavierAp Add Account 2","USD","America\/Montevideo",-3,1,"Javier Apaulaza Avegno",null,286557,0],"duration_ms":48.53,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_741300161237395","name":"JavierAp Add Account 2"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1370588717662780"," JavierAp Add Account 3","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,498114,21547],"duration_ms":44.83,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_1370588717662780","name":" JavierAp Add Account 3"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1378540443110986","BLUEBERRY $ for (qualitasinteractive.com) 82","USD","America\/New_York",-4,1,"",null,125306,0],"duration_ms":44.67,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_1378540443110986","name":"BLUEBERRY $ for (qualitasinteractive.com) 82"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1214313446330764","JavierAp Add Account 4","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,170841,2295],"duration_ms":44.96,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_1214313446330764","name":"JavierAp Add Account 4"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_3593657684101868","Add Account 1 Javier Comp 2 BM","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,11927,0],"duration_ms":44.83,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_3593657684101868","name":"Add Account 1 Javier Comp 2 BM"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_24174913148764727","JavierAp Add Account 5","USD","America\/Montevideo",-3,1,"",null,0,0],"duration_ms":44.34,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Account synced {"account_id":"act_24174913148764727","name":"JavierAp Add Account 5"}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"UPDATE sync_logs SET records_processed = ?, records_created = ?, records_updated = ?, status = ?, error_message = ?, completed_at = ? WHERE id = ?","params":[8,8,0,"completed",null,"2025-06-05 21:50:02","1"],"duration_ms":44.58,"rows_affected":1}
[2025-06-05 21:50:02] INFO: Sync completed {"log_id":"1","status":"completed","stats":{"accounts_synced":8,"campaigns_synced":0,"adsets_synced":0,"ads_synced":0,"costs_synced":0,"errors":0}}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":46.08,"rows_affected":8}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.49,"rows_affected":1}
[2025-06-05 21:50:02] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.38,"rows_affected":1}
[2025-06-05 21:50:40] DEBUG: Database connection established 
[2025-06-05 21:50:40] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":45.17,"rows_affected":1}
[2025-06-05 21:50:40] ERROR: Query failed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY fc.spend DESC NULLS LAST\n            ","params":["act_1370588717662780"],"error":"SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'NULLS LAST' at line 24"}
[2025-06-05 21:50:40] ERROR: Query failed: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'NULLS LAST' at line 24 {"exception":{"class":"Exception","message":"Query failed: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'NULLS LAST' at line 24","code":0,"file":"\/var\/www\/html\/savingsnewsnow.com\/apps\/fbtracker\/classes\/Database.php","line":105,"trace":"#0 \/var\/www\/html\/savingsnewsnow.com\/apps\/fbtracker\/classes\/Database.php(121): Database->query('\\n              ...', Array)\n#1 \/var\/www\/html\/savingsnewsnow.com\/apps\/fbtracker\/public\/index.php(137): Database->fetchAll('\\n              ...', Array)\n#2 {main}"}}
[2025-06-05 21:54:33] DEBUG: Database connection established 
[2025-06-05 21:54:33] DEBUG: Query executed {"sql":"INSERT INTO sync_logs (sync_type, sync_date, status, started_at) VALUES (?, ?, ?, ?)","params":["facebook","2025-06-05 21:54:33","running","2025-06-05 21:54:33"],"duration_ms":46.49,"rows_affected":1}
[2025-06-05 21:54:33] INFO: Sync started {"type":"facebook","log_id":"2"}
[2025-06-05 21:54:33] INFO: Fetching ad accounts 
[2025-06-05 21:54:34] INFO: API Call to Facebook {"endpoint":"\/me\/adaccounts","params":{"method":"GET","params":{"fields":"id,name,currency,timezone_name,timezone_offset_hours_utc,account_status,business_name,amount_spent,balance","limit":100,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":597.3,"response_size":2003}
[2025-06-05 21:54:34] INFO: Ad accounts fetched {"count":8}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_223217352222205","Javier Apaulaza","USD","America\/Montevideo",-3,1,"",null,0,0],"duration_ms":48.4,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_223217352222205","name":"Javier Apaulaza"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_368576981173158","JavierAp Add Account","USD","America\/Montevideo",-3,1,"LewAR",null,833267,0],"duration_ms":45.47,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_368576981173158","name":"JavierAp Add Account"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_741300161237395","JavierAp Add Account 2","USD","America\/Montevideo",-3,1,"Javier Apaulaza Avegno",null,286557,0],"duration_ms":45.29,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_741300161237395","name":"JavierAp Add Account 2"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1370588717662780"," JavierAp Add Account 3","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,498114,21547],"duration_ms":45.82,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_1370588717662780","name":" JavierAp Add Account 3"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1378540443110986","BLUEBERRY $ for (qualitasinteractive.com) 82","USD","America\/New_York",-4,1,"",null,125306,0],"duration_ms":45.44,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_1378540443110986","name":"BLUEBERRY $ for (qualitasinteractive.com) 82"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1214313446330764","JavierAp Add Account 4","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,170841,2295],"duration_ms":45.72,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_1214313446330764","name":"JavierAp Add Account 4"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_3593657684101868","Add Account 1 Javier Comp 2 BM","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,11927,0],"duration_ms":45,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_3593657684101868","name":"Add Account 1 Javier Comp 2 BM"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_24174913148764727","JavierAp Add Account 5","USD","America\/Montevideo",-3,1,"",null,0,0],"duration_ms":45.51,"rows_affected":2}
[2025-06-05 21:54:34] INFO: Account synced {"account_id":"act_24174913148764727","name":"JavierAp Add Account 5"}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"UPDATE sync_logs SET records_processed = ?, records_created = ?, records_updated = ?, status = ?, error_message = ?, completed_at = ? WHERE id = ?","params":[8,8,0,"completed",null,"2025-06-05 21:54:34","2"],"duration_ms":45.45,"rows_affected":1}
[2025-06-05 21:54:34] INFO: Sync completed {"log_id":"2","status":"completed","stats":{"accounts_synced":8,"campaigns_synced":0,"adsets_synced":0,"ads_synced":0,"costs_synced":0,"errors":0}}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.14,"rows_affected":8}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.23,"rows_affected":1}
[2025-06-05 21:54:34] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.23,"rows_affected":1}
[2025-06-05 21:54:39] DEBUG: Database connection established 
[2025-06-05 21:54:39] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":45.2,"rows_affected":1}
[2025-06-05 21:54:39] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":50.42,"rows_affected":0}
[2025-06-05 21:54:45] DEBUG: Database connection established 
[2025-06-05 21:54:45] DEBUG: Query executed {"sql":"INSERT INTO sync_logs (sync_type, sync_date, status, started_at) VALUES (?, ?, ?, ?)","params":["facebook","2025-06-05 21:54:45","running","2025-06-05 21:54:45"],"duration_ms":45.07,"rows_affected":1}
[2025-06-05 21:54:45] INFO: Sync started {"type":"facebook","log_id":"3"}
[2025-06-05 21:54:45] INFO: Fetching campaigns {"account_id":"act_1370588717662780"}
[2025-06-05 21:54:46] INFO: API Call to Facebook {"endpoint":"\/act_1370588717662780\/campaigns","params":{"method":"GET","params":{"fields":"id,name,status,objective,created_time,updated_time,daily_budget,lifetime_budget","limit":500,"filtering":"[{\"field\":\"effective_status\",\"operator\":\"IN\",\"value\":[\"ACTIVE\",\"PAUSED\",\"PENDING_REVIEW\",\"DISAPPROVED\",\"PREAPPROVED\"]}]","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":483.06,"response_size":8630}
[2025-06-05 21:54:46] INFO: Campaigns fetched {"account_id":"act_1370588717662780","count":34}
[2025-06-05 21:54:46] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224733492130185","act_1370588717662780","BarxBuddy US LP 1","ACTIVE"],"duration_ms":45.94,"rows_affected":1}
[2025-06-05 21:54:46] DEBUG: Fetching adsets {"campaign_id":"120224733492130185"}
[2025-06-05 21:54:46] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":400.83,"response_size":879}
[2025-06-05 21:54:46] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734772340185","120224733492130185","ADSET 003","ACTIVE"],"duration_ms":45.83,"rows_affected":1}
[2025-06-05 21:54:46] DEBUG: Fetching ads {"adset_id":"120224734772340185"}
[2025-06-05 21:54:47] INFO: API Call to Facebook {"endpoint":"\/120224734772340185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":274.85,"response_size":547}
[2025-06-05 21:54:47] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734772330185","120224734772340185","120224733492130185","ADSET003-AD001","ACTIVE"],"duration_ms":45.89,"rows_affected":1}
[2025-06-05 21:54:47] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734451540185","120224733492130185","ADSET 002","ACTIVE"],"duration_ms":45.23,"rows_affected":1}
[2025-06-05 21:54:47] DEBUG: Fetching ads {"adset_id":"120224734451540185"}
[2025-06-05 21:54:47] INFO: API Call to Facebook {"endpoint":"\/120224734451540185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":455.65,"response_size":543}
[2025-06-05 21:54:47] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734451530185","120224734451540185","120224733492130185","ADSET002-AD001","ACTIVE"],"duration_ms":45.27,"rows_affected":1}
[2025-06-05 21:54:47] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224733492230185","120224733492130185","ADSET 001","PAUSED"],"duration_ms":45.34,"rows_affected":1}
[2025-06-05 21:54:47] DEBUG: Fetching ads {"adset_id":"120224733492230185"}
[2025-06-05 21:54:48] INFO: API Call to Facebook {"endpoint":"\/120224733492230185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":343.92,"response_size":549}
[2025-06-05 21:54:48] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224733492390185","120224733492230185","120224733492130185","ADSET001-AD001","ACTIVE"],"duration_ms":44.84,"rows_affected":1}
[2025-06-05 21:54:48] DEBUG: Fetching insights {"object_id":"120224733492130185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:48] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":496.13,"response_size":706}
[2025-06-05 21:54:48] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",52.87,684,43,"2025-06-02"],"duration_ms":47.12,"rows_affected":1}
[2025-06-05 21:54:48] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",56.44,780,36,"2025-06-03"],"duration_ms":44.8,"rows_affected":1}
[2025-06-05 21:54:48] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",66.61,986,48,"2025-06-04"],"duration_ms":45.24,"rows_affected":1}
[2025-06-05 21:54:48] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",40.05,632,40,"2025-06-05"],"duration_ms":44.61,"rows_affected":1}
[2025-06-05 21:54:48] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":44.49,"rows_affected":3}
[2025-06-05 21:54:48] DEBUG: Fetching insights {"object_id":"120224733492230185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:49] INFO: API Call to Facebook {"endpoint":"\/120224733492230185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":530.07,"response_size":548}
[2025-06-05 21:54:49] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",17.19,233,20,"2025-06-02"],"duration_ms":44.91,"rows_affected":1}
[2025-06-05 21:54:49] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",18.18,313,8,"2025-06-03"],"duration_ms":44.83,"rows_affected":1}
[2025-06-05 21:54:49] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",21.77,345,15,"2025-06-04"],"duration_ms":44.61,"rows_affected":1}
[2025-06-05 21:54:49] DEBUG: Fetching insights {"object_id":"120224734451540185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:49] INFO: API Call to Facebook {"endpoint":"\/120224734451540185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":439.44,"response_size":708}
[2025-06-05 21:54:49] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",18.49,193,13,"2025-06-02"],"duration_ms":45.19,"rows_affected":1}
[2025-06-05 21:54:49] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",18.67,228,16,"2025-06-03"],"duration_ms":45.03,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",22.71,327,21,"2025-06-04"],"duration_ms":45.59,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",19.33,345,21,"2025-06-05"],"duration_ms":45.03,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Fetching insights {"object_id":"120224734772340185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:50] INFO: API Call to Facebook {"endpoint":"\/120224734772340185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":411.75,"response_size":703}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",17.19,258,10,"2025-06-02"],"duration_ms":45.18,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",19.59,239,12,"2025-06-03"],"duration_ms":45.27,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",22.13,314,12,"2025-06-04"],"duration_ms":45.44,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",20.72,287,19,"2025-06-05"],"duration_ms":44.86,"rows_affected":1}
[2025-06-05 21:54:50] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":44.67,"rows_affected":3}
[2025-06-05 21:54:50] DEBUG: Fetching insights {"object_id":"120224733492390185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:51] INFO: API Call to Facebook {"endpoint":"\/120224733492390185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":488.88,"response_size":548}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",17.19,233,20,"2025-06-02"],"duration_ms":44.88,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",18.18,313,8,"2025-06-03"],"duration_ms":44.72,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",21.77,345,15,"2025-06-04"],"duration_ms":44.95,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Fetching insights {"object_id":"120224734451530185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:51] INFO: API Call to Facebook {"endpoint":"\/120224734451530185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":420.11,"response_size":708}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",18.49,193,13,"2025-06-02"],"duration_ms":44.8,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",18.67,228,16,"2025-06-03"],"duration_ms":45.09,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",22.71,327,21,"2025-06-04"],"duration_ms":44.63,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",19.33,345,21,"2025-06-05"],"duration_ms":44.83,"rows_affected":1}
[2025-06-05 21:54:51] DEBUG: Fetching insights {"object_id":"120224734772330185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:52] INFO: API Call to Facebook {"endpoint":"\/120224734772330185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":365.05,"response_size":703}
[2025-06-05 21:54:52] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",17.19,258,10,"2025-06-02"],"duration_ms":44.82,"rows_affected":1}
[2025-06-05 21:54:52] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",19.59,239,12,"2025-06-03"],"duration_ms":45.24,"rows_affected":1}
[2025-06-05 21:54:52] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",22.13,314,12,"2025-06-04"],"duration_ms":44.98,"rows_affected":1}
[2025-06-05 21:54:52] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",20.72,287,19,"2025-06-05"],"duration_ms":44.66,"rows_affected":1}
[2025-06-05 21:54:52] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219270573570185","act_1370588717662780","SANDBOX | WELLAMOON | Abierta","PAUSED"],"duration_ms":44.51,"rows_affected":1}
[2025-06-05 21:54:52] DEBUG: Fetching adsets {"campaign_id":"120219270573570185"}
[2025-06-05 21:54:52] INFO: API Call to Facebook {"endpoint":"\/120219270573570185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":303.11,"response_size":550}
[2025-06-05 21:54:52] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON","ACTIVE"],"duration_ms":44.79,"rows_affected":1}
[2025-06-05 21:54:52] DEBUG: Fetching ads {"adset_id":"120219270573580185"}
[2025-06-05 21:54:53] INFO: API Call to Facebook {"endpoint":"\/120219270573580185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":467.12,"response_size":5640}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283907700185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | OFF | CR-2 | TP-5 | TT-8 | LP-8 | Ad14","PAUSED"],"duration_ms":45.07,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847600185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-4 | TT-7 | LP-8 | Ad2","ACTIVE"],"duration_ms":44.82,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847500185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-4 | TT-7 | LP-8 | Ad3","ACTIVE"],"duration_ms":44.83,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283683460185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-4 | TT-8 | LP-8 | Ad11","ACTIVE"],"duration_ms":44.74,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847620185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-5 | TT-7 | LP-8 | Ad6","ACTIVE"],"duration_ms":44.89,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847530185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-6 | TT-7 | LP-8 | Ad9","ACTIVE"],"duration_ms":45.11,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847510185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-5 | TT-7 | LP-8 | Ad5","ACTIVE"],"duration_ms":45.12,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847610185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-5 | TT-7 | LP-8 | Ad4","ACTIVE"],"duration_ms":44.98,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283907690185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-5 | TT-8 | LP-8 | Ad13","ACTIVE"],"duration_ms":44.71,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283683470185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-4 | TT-8 | LP-8 | Ad10","ACTIVE"],"duration_ms":44.55,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283907680185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-5 | TT-8 | LP-8 | Ad15","ACTIVE"],"duration_ms":48.2,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219284028810185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-6 | TT-8 | LP-8 | Ad16","ACTIVE"],"duration_ms":45.01,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847630185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-6 | TT-7 | LP-8 | Ad8","ACTIVE"],"duration_ms":45.01,"rows_affected":1}
[2025-06-05 21:54:53] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283683450185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-4 | TT-8 | LP-8 | Ad12","ACTIVE"],"duration_ms":45,"rows_affected":1}
[2025-06-05 21:54:54] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219284028820185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-6 | TT-8 | LP-8 | Ad17","ACTIVE"],"duration_ms":44.74,"rows_affected":1}
[2025-06-05 21:54:54] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847520185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-6 | TT-7 | LP-8 | Ad7","ACTIVE"],"duration_ms":44.71,"rows_affected":1}
[2025-06-05 21:54:54] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219284028830185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-6 | TT-8 | LP-8 | Ad18","ACTIVE"],"duration_ms":44.55,"rows_affected":1}
[2025-06-05 21:54:54] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219270573600185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-4 | TT-7 | LP-8","ACTIVE"],"duration_ms":44.87,"rows_affected":1}
[2025-06-05 21:54:54] DEBUG: Fetching insights {"object_id":"120219270573570185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:54] INFO: API Call to Facebook {"endpoint":"\/120219270573570185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":380.39,"response_size":31}
[2025-06-05 21:54:54] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120219270573570185"],"duration_ms":45.06,"rows_affected":1}
[2025-06-05 21:54:54] DEBUG: Fetching insights {"object_id":"120219270573580185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:55] INFO: API Call to Facebook {"endpoint":"\/120219270573580185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":415.85,"response_size":31}
[2025-06-05 21:54:55] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE campaign_id = ?","params":["120219270573570185"],"duration_ms":44.8,"rows_affected":18}
[2025-06-05 21:54:55] DEBUG: Fetching insights {"object_id":"120219270573600185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:55] INFO: API Call to Facebook {"endpoint":"\/120219270573600185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":389.88,"response_size":31}
[2025-06-05 21:54:55] DEBUG: Fetching insights {"object_id":"120219281847500185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:55] INFO: API Call to Facebook {"endpoint":"\/120219281847500185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":405.41,"response_size":31}
[2025-06-05 21:54:55] DEBUG: Fetching insights {"object_id":"120219281847510185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:56] INFO: API Call to Facebook {"endpoint":"\/120219281847510185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":349.39,"response_size":31}
[2025-06-05 21:54:56] DEBUG: Fetching insights {"object_id":"120219281847520185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:56] INFO: API Call to Facebook {"endpoint":"\/120219281847520185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":350.74,"response_size":31}
[2025-06-05 21:54:56] DEBUG: Fetching insights {"object_id":"120219281847530185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:56] INFO: API Call to Facebook {"endpoint":"\/120219281847530185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":380.28,"response_size":31}
[2025-06-05 21:54:56] DEBUG: Fetching insights {"object_id":"120219281847600185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:57] INFO: API Call to Facebook {"endpoint":"\/120219281847600185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":321.55,"response_size":31}
[2025-06-05 21:54:57] DEBUG: Fetching insights {"object_id":"120219281847610185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:57] INFO: API Call to Facebook {"endpoint":"\/120219281847610185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":341.6,"response_size":31}
[2025-06-05 21:54:57] DEBUG: Fetching insights {"object_id":"120219281847620185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:58] INFO: API Call to Facebook {"endpoint":"\/120219281847620185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":408.67,"response_size":31}
[2025-06-05 21:54:58] DEBUG: Fetching insights {"object_id":"120219281847630185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:58] INFO: API Call to Facebook {"endpoint":"\/120219281847630185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":321.86,"response_size":31}
[2025-06-05 21:54:58] DEBUG: Fetching insights {"object_id":"120219283683450185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:58] INFO: API Call to Facebook {"endpoint":"\/120219283683450185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":572.14,"response_size":31}
[2025-06-05 21:54:58] DEBUG: Fetching insights {"object_id":"120219283683460185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:59] INFO: API Call to Facebook {"endpoint":"\/120219283683460185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":367.43,"response_size":31}
[2025-06-05 21:54:59] DEBUG: Fetching insights {"object_id":"120219283683470185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:54:59] INFO: API Call to Facebook {"endpoint":"\/120219283683470185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":353.11,"response_size":31}
[2025-06-05 21:54:59] DEBUG: Fetching insights {"object_id":"120219283907680185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:00] INFO: API Call to Facebook {"endpoint":"\/120219283907680185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":393.39,"response_size":31}
[2025-06-05 21:55:00] DEBUG: Fetching insights {"object_id":"120219283907690185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:00] INFO: API Call to Facebook {"endpoint":"\/120219283907690185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":403.27,"response_size":31}
[2025-06-05 21:55:00] DEBUG: Fetching insights {"object_id":"120219283907700185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:00] INFO: API Call to Facebook {"endpoint":"\/120219283907700185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":426.29,"response_size":31}
[2025-06-05 21:55:00] DEBUG: Fetching insights {"object_id":"120219284028810185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:01] INFO: API Call to Facebook {"endpoint":"\/120219284028810185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":413.57,"response_size":31}
[2025-06-05 21:55:01] DEBUG: Fetching insights {"object_id":"120219284028820185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:01] INFO: API Call to Facebook {"endpoint":"\/120219284028820185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":351.37,"response_size":31}
[2025-06-05 21:55:01] DEBUG: Fetching insights {"object_id":"120219284028830185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:02] INFO: API Call to Facebook {"endpoint":"\/120219284028830185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":446.67,"response_size":31}
[2025-06-05 21:55:02] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217274349160185","act_1370588717662780","Wellamoon Testing ADV 3-4-5-6","PAUSED"],"duration_ms":44.1,"rows_affected":1}
[2025-06-05 21:55:02] DEBUG: Fetching adsets {"campaign_id":"120217274349160185"}
[2025-06-05 21:55:02] INFO: API Call to Facebook {"endpoint":"\/120217274349160185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":332.21,"response_size":2145}
[2025-06-05 21:55:02] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218210593890185","120217274349160185","Wellamoon Testing IMG003_ADV6","PAUSED"],"duration_ms":45.1,"rows_affected":1}
[2025-06-05 21:55:02] DEBUG: Fetching ads {"adset_id":"120218210593890185"}
[2025-06-05 21:55:02] INFO: API Call to Facebook {"endpoint":"\/120218210593890185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":480.56,"response_size":556}
[2025-06-05 21:55:03] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218210593880185","120218210593890185","120217274349160185","Wellamoon Testing IMG003_ADV6","ACTIVE"],"duration_ms":45.3,"rows_affected":1}
[2025-06-05 21:55:03] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218209793850185","120217274349160185","Wellamoon Testing IMG003_ADV5","ACTIVE"],"duration_ms":45.1,"rows_affected":1}
[2025-06-05 21:55:03] DEBUG: Fetching ads {"adset_id":"120218209793850185"}
[2025-06-05 21:55:03] INFO: API Call to Facebook {"endpoint":"\/120218209793850185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":386.14,"response_size":554}
[2025-06-05 21:55:03] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218209793840185","120218209793850185","120217274349160185","Wellamoon Testing IMG003_ADV5","ACTIVE"],"duration_ms":45.05,"rows_affected":1}
[2025-06-05 21:55:03] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218208572860185","120217274349160185","Wellamoon Testing IMG003_ADV4","ACTIVE"],"duration_ms":44.98,"rows_affected":1}
[2025-06-05 21:55:03] DEBUG: Fetching ads {"adset_id":"120218208572860185"}
[2025-06-05 21:55:03] INFO: API Call to Facebook {"endpoint":"\/120218208572860185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":313.22,"response_size":560}
[2025-06-05 21:55:03] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218208572870185","120218208572860185","120217274349160185","Wellamoon Testing IMG003_ADV4","ACTIVE"],"duration_ms":44.77,"rows_affected":1}
[2025-06-05 21:55:03] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218013123980185","120217274349160185","Wellamoon Testing 05_ADV6","PAUSED"],"duration_ms":44.88,"rows_affected":1}
[2025-06-05 21:55:03] DEBUG: Fetching ads {"adset_id":"120218013123980185"}
[2025-06-05 21:55:04] INFO: API Call to Facebook {"endpoint":"\/120218013123980185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":772.85,"response_size":556}
[2025-06-05 21:55:04] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218013123970185","120218013123980185","120217274349160185","Wellamoon Testing 05_ADV6","ACTIVE"],"duration_ms":44.91,"rows_affected":1}
[2025-06-05 21:55:04] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218012394950185","120217274349160185","Wellamoon Testing 05_ADV5","PAUSED"],"duration_ms":44.96,"rows_affected":1}
[2025-06-05 21:55:04] DEBUG: Fetching ads {"adset_id":"120218012394950185"}
[2025-06-05 21:55:05] INFO: API Call to Facebook {"endpoint":"\/120218012394950185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":507.07,"response_size":552}
[2025-06-05 21:55:05] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218012394940185","120218012394950185","120217274349160185","Wellamoon Testing 05_ADV5","ACTIVE"],"duration_ms":45.13,"rows_affected":1}
[2025-06-05 21:55:05] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218011716430185","120217274349160185","Wellamoon Testing 05_ADV4","PAUSED"],"duration_ms":45.47,"rows_affected":1}
[2025-06-05 21:55:05] DEBUG: Fetching ads {"adset_id":"120218011716430185"}
[2025-06-05 21:55:05] INFO: API Call to Facebook {"endpoint":"\/120218011716430185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":481.65,"response_size":560}
[2025-06-05 21:55:05] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218011716440185","120218011716430185","120217274349160185","Wellamoon Testing 05_ADV4","ACTIVE"],"duration_ms":44.9,"rows_affected":1}
[2025-06-05 21:55:06] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382348520185","120217274349160185","Wellamoon Testing IMG003_ADV3","ACTIVE"],"duration_ms":44.96,"rows_affected":1}
[2025-06-05 21:55:06] DEBUG: Fetching ads {"adset_id":"120217382348520185"}
[2025-06-05 21:55:06] INFO: API Call to Facebook {"endpoint":"\/120217382348520185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":522.24,"response_size":560}
[2025-06-05 21:55:06] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382348510185","120217382348520185","120217274349160185","Wellamoon Testing IMG003_ADV3","ACTIVE"],"duration_ms":44.56,"rows_affected":1}
[2025-06-05 21:55:06] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382155840185","120217274349160185","Wellamoon Testing IMG001_ADV3","PAUSED"],"duration_ms":44.39,"rows_affected":1}
[2025-06-05 21:55:06] DEBUG: Fetching ads {"adset_id":"120217382155840185"}
[2025-06-05 21:55:07] INFO: API Call to Facebook {"endpoint":"\/120217382155840185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":445.92,"response_size":556}
[2025-06-05 21:55:07] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382155830185","120217382155840185","120217274349160185","Wellamoon Testing IMG001_ADV3","ACTIVE"],"duration_ms":44.96,"rows_affected":1}
[2025-06-05 21:55:07] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217274349150185","120217274349160185","Wellamoon Testing 05_ADV3","PAUSED"],"duration_ms":44.58,"rows_affected":1}
[2025-06-05 21:55:07] DEBUG: Fetching ads {"adset_id":"120217274349150185"}
[2025-06-05 21:55:07] INFO: API Call to Facebook {"endpoint":"\/120217274349150185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":539.86,"response_size":558}
[2025-06-05 21:55:07] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217274349170185","120217274349150185","120217274349160185","Wellamoon Testing 05_ADV3","ACTIVE"],"duration_ms":45.1,"rows_affected":1}
[2025-06-05 21:55:07] DEBUG: Fetching insights {"object_id":"120217274349160185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:08] INFO: API Call to Facebook {"endpoint":"\/120217274349160185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":366.13,"response_size":31}
[2025-06-05 21:55:08] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120217274349160185"],"duration_ms":44.87,"rows_affected":9}
[2025-06-05 21:55:08] DEBUG: Fetching insights {"object_id":"120217274349150185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:08] INFO: API Call to Facebook {"endpoint":"\/120217274349150185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":330.84,"response_size":31}
[2025-06-05 21:55:08] DEBUG: Fetching insights {"object_id":"120217382155840185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:08] INFO: API Call to Facebook {"endpoint":"\/120217382155840185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":412.67,"response_size":31}
[2025-06-05 21:55:08] DEBUG: Fetching insights {"object_id":"120217382348520185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:09] INFO: API Call to Facebook {"endpoint":"\/120217382348520185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":470.85,"response_size":31}
[2025-06-05 21:55:09] DEBUG: Fetching insights {"object_id":"120218011716430185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:09] INFO: API Call to Facebook {"endpoint":"\/120218011716430185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":391.19,"response_size":31}
[2025-06-05 21:55:09] DEBUG: Fetching insights {"object_id":"120218012394950185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:10] INFO: API Call to Facebook {"endpoint":"\/120218012394950185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":357.19,"response_size":31}
[2025-06-05 21:55:10] DEBUG: Fetching insights {"object_id":"120218013123980185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:10] INFO: API Call to Facebook {"endpoint":"\/120218013123980185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":461.8,"response_size":31}
[2025-06-05 21:55:10] DEBUG: Fetching insights {"object_id":"120218208572860185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:11] INFO: API Call to Facebook {"endpoint":"\/120218208572860185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":413.88,"response_size":31}
[2025-06-05 21:55:11] DEBUG: Fetching insights {"object_id":"120218209793850185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:11] INFO: API Call to Facebook {"endpoint":"\/120218209793850185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":427.53,"response_size":31}
[2025-06-05 21:55:11] DEBUG: Fetching insights {"object_id":"120218210593890185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:11] INFO: API Call to Facebook {"endpoint":"\/120218210593890185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":361.68,"response_size":31}
[2025-06-05 21:55:11] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE campaign_id = ?","params":["120217274349160185"],"duration_ms":44.92,"rows_affected":9}
[2025-06-05 21:55:11] DEBUG: Fetching insights {"object_id":"120217274349170185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:12] INFO: API Call to Facebook {"endpoint":"\/120217274349170185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":350.08,"response_size":31}
[2025-06-05 21:55:12] DEBUG: Fetching insights {"object_id":"120217382155830185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:12] INFO: API Call to Facebook {"endpoint":"\/120217382155830185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":372.65,"response_size":31}
[2025-06-05 21:55:12] DEBUG: Fetching insights {"object_id":"120217382348510185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:12] INFO: API Call to Facebook {"endpoint":"\/120217382348510185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":385.17,"response_size":31}
[2025-06-05 21:55:12] DEBUG: Fetching insights {"object_id":"120218011716440185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:13] INFO: API Call to Facebook {"endpoint":"\/120218011716440185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":543.37,"response_size":31}
[2025-06-05 21:55:13] DEBUG: Fetching insights {"object_id":"120218012394940185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:14] INFO: API Call to Facebook {"endpoint":"\/120218012394940185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":504.61,"response_size":31}
[2025-06-05 21:55:14] DEBUG: Fetching insights {"object_id":"120218013123970185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:14] INFO: API Call to Facebook {"endpoint":"\/120218013123970185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":456.23,"response_size":31}
[2025-06-05 21:55:14] DEBUG: Fetching insights {"object_id":"120218208572870185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:14] INFO: API Call to Facebook {"endpoint":"\/120218208572870185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":414.17,"response_size":31}
[2025-06-05 21:55:14] DEBUG: Fetching insights {"object_id":"120218209793840185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:15] INFO: API Call to Facebook {"endpoint":"\/120218209793840185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":424.71,"response_size":31}
[2025-06-05 21:55:15] DEBUG: Fetching insights {"object_id":"120218210593880185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 21:55:15] INFO: API Call to Facebook {"endpoint":"\/120218210593880185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":341.97,"response_size":31}
[2025-06-05 21:55:15] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217273798940185","act_1370588717662780","Wellamoon Testing ADV 2","PAUSED"],"duration_ms":44.58,"rows_affected":1}
[2025-06-05 21:55:15] DEBUG: Fetching adsets {"campaign_id":"120217273798940185"}
[2025-06-05 21:55:16] INFO: API Call to Facebook {"endpoint":"\/120217273798940185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":403.22,"response_size":400}
[2025-06-05 21:55:16] WARNING: Facebook API rate limit hit {"endpoint":"\/120217273798940185\/adsets","attempt":1}
[2025-06-05 21:55:17] INFO: API Call to Facebook {"endpoint":"\/120217273798940185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":274.53,"response_size":400}
[2025-06-05 21:55:17] WARNING: Facebook API rate limit hit {"endpoint":"\/120217273798940185\/adsets","attempt":2}
[2025-06-05 21:55:19] INFO: API Call to Facebook {"endpoint":"\/120217273798940185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":290.55,"response_size":400}
[2025-06-05 21:55:19] WARNING: Facebook API rate limit hit {"endpoint":"\/120217273798940185\/adsets","attempt":3}
[2025-06-05 21:55:19] ERROR: Facebook API request failed {"endpoint":"\/120217273798940185\/adsets","attempt":3,"error":"User request limit reached"}
[2025-06-05 21:55:19] ERROR: Failed to sync campaign structure {"campaign_id":"120217273798940185","error":"User request limit reached"}
[2025-06-05 21:55:19] ERROR: Sync account campaigns failed {"account_id":"act_1370588717662780","error":"User request limit reached"}
[2025-06-05 21:55:19] DEBUG: Query executed {"sql":"UPDATE sync_logs SET records_processed = ?, records_created = ?, records_updated = ?, status = ?, error_message = ?, completed_at = ? WHERE id = ?","params":[73,73,0,"failed","User request limit reached","2025-06-05 21:55:19","3"],"duration_ms":44.53,"rows_affected":1}
[2025-06-05 21:55:19] INFO: Sync completed {"log_id":"3","status":"failed","stats":{"accounts_synced":0,"campaigns_synced":4,"adsets_synced":13,"ads_synced":30,"costs_synced":26,"errors":0}}
[2025-06-05 21:55:19] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":44.37,"rows_affected":1}
[2025-06-05 21:55:19] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.57,"rows_affected":4}
[2025-06-05 21:55:43] DEBUG: Database connection established 
[2025-06-05 21:55:43] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.55,"rows_affected":1}
[2025-06-05 21:55:43] DEBUG: Query executed {"sql":"\n                SELECT \n                    date,\n                    spend,\n                    impressions,\n                    clicks,\n                    cpm,\n                    cpc\n                FROM facebook_costs\n                WHERE entity_id = ? \n                    AND entity_type = 'campaign'\n                    AND date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                ORDER BY date DESC\n            ","params":["120224733492130185"],"duration_ms":44.75,"rows_affected":4}
[2025-06-05 21:55:43] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.*,\n                    ads.name as adset_name,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                WHERE a.campaign_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["120224733492130185"],"duration_ms":45.93,"rows_affected":3}
[2025-06-05 22:00:44] DEBUG: Database connection established 
[2025-06-05 22:00:44] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.73,"rows_affected":1}
[2025-06-05 22:00:44] DEBUG: Query executed {"sql":"\n                SELECT \n                    date,\n                    spend,\n                    impressions,\n                    clicks,\n                    cpm,\n                    cpc\n                FROM facebook_costs\n                WHERE entity_id = ? \n                    AND entity_type = 'campaign'\n                    AND date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                ORDER BY date DESC\n            ","params":["120224733492130185"],"duration_ms":46.93,"rows_affected":4}
[2025-06-05 22:00:44] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.*,\n                    ads.name as adset_name,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                WHERE a.campaign_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["120224733492130185"],"duration_ms":45.31,"rows_affected":3}
[2025-06-05 22:05:45] DEBUG: Database connection established 
[2025-06-05 22:05:46] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.01,"rows_affected":1}
[2025-06-05 22:05:46] DEBUG: Query executed {"sql":"\n                SELECT \n                    date,\n                    spend,\n                    impressions,\n                    clicks,\n                    cpm,\n                    cpc\n                FROM facebook_costs\n                WHERE entity_id = ? \n                    AND entity_type = 'campaign'\n                    AND date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                ORDER BY date DESC\n            ","params":["120224733492130185"],"duration_ms":45.75,"rows_affected":4}
[2025-06-05 22:05:46] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.*,\n                    ads.name as adset_name,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                WHERE a.campaign_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["120224733492130185"],"duration_ms":45.59,"rows_affected":3}
[2025-06-05 22:10:47] DEBUG: Database connection established 
[2025-06-05 22:10:47] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.24,"rows_affected":1}
[2025-06-05 22:10:47] DEBUG: Query executed {"sql":"\n                SELECT \n                    date,\n                    spend,\n                    impressions,\n                    clicks,\n                    cpm,\n                    cpc\n                FROM facebook_costs\n                WHERE entity_id = ? \n                    AND entity_type = 'campaign'\n                    AND date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                ORDER BY date DESC\n            ","params":["120224733492130185"],"duration_ms":46.06,"rows_affected":4}
[2025-06-05 22:10:47] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.*,\n                    ads.name as adset_name,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                WHERE a.campaign_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["120224733492130185"],"duration_ms":46.24,"rows_affected":3}
[2025-06-05 22:14:18] DEBUG: Database connection established 
[2025-06-05 22:14:18] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":45.12,"rows_affected":1}
[2025-06-05 22:14:18] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":47.9,"rows_affected":4}
[2025-06-05 22:14:25] DEBUG: Database connection established 
[2025-06-05 22:14:26] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":45.21,"rows_affected":1}
[2025-06-05 22:14:26] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.83,"rows_affected":4}
[2025-06-05 22:14:35] DEBUG: Database connection established 
[2025-06-05 22:14:35] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.22,"rows_affected":1}
[2025-06-05 22:14:35] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":51.42,"rows_affected":3}
[2025-06-05 22:18:17] DEBUG: Database connection established 
[2025-06-05 22:18:17] DEBUG: Query executed {"sql":"SELECT * FROM campaigns WHERE id = ?","params":["120224733492130185"],"duration_ms":45.16,"rows_affected":1}
[2025-06-05 22:18:17] DEBUG: Query executed {"sql":"SELECT * FROM adsets WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":45.53,"rows_affected":3}
[2025-06-05 22:18:18] DEBUG: Query executed {"sql":"SELECT * FROM ads WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":45.04,"rows_affected":3}
[2025-06-05 22:18:18] DEBUG: Query executed {"sql":"\n    SELECT * FROM facebook_costs \n    WHERE entity_id = ? AND entity_type = 'campaign' \n    ORDER BY date DESC \n    LIMIT 10\n","params":["120224733492130185"],"duration_ms":45.05,"rows_affected":4}
[2025-06-05 22:18:18] DEBUG: Query executed {"sql":"\n    SELECT \n        fc.*,\n        ads.name as adset_name\n    FROM facebook_costs fc\n    JOIN adsets ads ON fc.entity_id = ads.id\n    WHERE ads.campaign_id = ? AND fc.entity_type = 'adset'\n    ORDER BY fc.date DESC\n    LIMIT 10\n","params":["120224733492130185"],"duration_ms":45.66,"rows_affected":10}
[2025-06-05 22:18:18] DEBUG: Query executed {"sql":"\n    SELECT \n        fc.*,\n        a.name as ad_name\n    FROM facebook_costs fc\n    JOIN ads a ON fc.entity_id = a.id\n    WHERE a.campaign_id = ? AND fc.entity_type = 'ad'\n    ORDER BY fc.date DESC\n    LIMIT 20\n","params":["120224733492130185"],"duration_ms":45.61,"rows_affected":11}
[2025-06-05 22:18:18] DEBUG: Query executed {"sql":"\n    SELECT * FROM sync_logs \n    WHERE sync_type = 'facebook' AND status = 'completed'\n    ORDER BY completed_at DESC \n    LIMIT 1\n","params":[],"duration_ms":44.87,"rows_affected":1}
[2025-06-05 22:19:36] DEBUG: Database connection established 
[2025-06-05 22:19:36] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.57,"rows_affected":1}
[2025-06-05 22:19:36] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":45.97,"rows_affected":3}
[2025-06-05 22:24:28] DEBUG: Database connection established 
[2025-06-05 22:24:28] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":51.96,"rows_affected":8}
[2025-06-05 22:24:28] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.64,"rows_affected":1}
[2025-06-05 22:24:28] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":46.31,"rows_affected":1}
[2025-06-05 22:24:42] DEBUG: Database connection established 
[2025-06-05 22:24:42] DEBUG: Query executed {"sql":"INSERT INTO sync_logs (sync_type, sync_date, status, started_at) VALUES (?, ?, ?, ?)","params":["facebook","2025-06-05 22:24:42","running","2025-06-05 22:24:42"],"duration_ms":45.44,"rows_affected":1}
[2025-06-05 22:24:42] INFO: Sync started {"type":"facebook","log_id":"4"}
[2025-06-05 22:24:42] INFO: Fetching ad accounts 
[2025-06-05 22:24:43] INFO: API Call to Facebook {"endpoint":"\/me\/adaccounts","params":{"method":"GET","params":{"fields":"id,name,currency,timezone_name,timezone_offset_hours_utc,account_status,business_name,amount_spent,balance","limit":100,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":1054.35,"response_size":2003}
[2025-06-05 22:24:43] INFO: Ad accounts fetched {"count":8}
[2025-06-05 22:24:43] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_223217352222205","Javier Apaulaza","USD","America\/Montevideo",-3,1,"",null,0,0],"duration_ms":48.3,"rows_affected":2}
[2025-06-05 22:24:43] INFO: Account synced {"account_id":"act_223217352222205","name":"Javier Apaulaza"}
[2025-06-05 22:24:43] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_368576981173158","JavierAp Add Account","USD","America\/Montevideo",-3,1,"LewAR",null,833267,0],"duration_ms":46.02,"rows_affected":2}
[2025-06-05 22:24:43] INFO: Account synced {"account_id":"act_368576981173158","name":"JavierAp Add Account"}
[2025-06-05 22:24:43] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_741300161237395","JavierAp Add Account 2","USD","America\/Montevideo",-3,1,"Javier Apaulaza Avegno",null,286557,0],"duration_ms":44.43,"rows_affected":2}
[2025-06-05 22:24:43] INFO: Account synced {"account_id":"act_741300161237395","name":"JavierAp Add Account 2"}
[2025-06-05 22:24:43] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1370588717662780"," JavierAp Add Account 3","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,498114,21714],"duration_ms":44.29,"rows_affected":2}
[2025-06-05 22:24:43] INFO: Account synced {"account_id":"act_1370588717662780","name":" JavierAp Add Account 3"}
[2025-06-05 22:24:43] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1378540443110986","BLUEBERRY $ for (qualitasinteractive.com) 82","USD","America\/New_York",-4,1,"",null,125306,0],"duration_ms":44.4,"rows_affected":2}
[2025-06-05 22:24:43] INFO: Account synced {"account_id":"act_1378540443110986","name":"BLUEBERRY $ for (qualitasinteractive.com) 82"}
[2025-06-05 22:24:43] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_1214313446330764","JavierAp Add Account 4","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,170841,2295],"duration_ms":44.72,"rows_affected":2}
[2025-06-05 22:24:43] INFO: Account synced {"account_id":"act_1214313446330764","name":"JavierAp Add Account 4"}
[2025-06-05 22:24:44] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_3593657684101868","Add Account 1 Javier Comp 2 BM","USD","America\/Montevideo",-3,1,"Javier Apaulaza",null,11927,0],"duration_ms":45.13,"rows_affected":2}
[2025-06-05 22:24:44] INFO: Account synced {"account_id":"act_3593657684101868","name":"Add Account 1 Javier Comp 2 BM"}
[2025-06-05 22:24:44] DEBUG: Query executed {"sql":"CALL upsert_ad_account(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)","params":["act_24174913148764727","JavierAp Add Account 5","USD","America\/Montevideo",-3,1,"",null,0,0],"duration_ms":45,"rows_affected":2}
[2025-06-05 22:24:44] INFO: Account synced {"account_id":"act_24174913148764727","name":"JavierAp Add Account 5"}
[2025-06-05 22:24:44] DEBUG: Query executed {"sql":"UPDATE sync_logs SET records_processed = ?, records_created = ?, records_updated = ?, status = ?, error_message = ?, completed_at = ? WHERE id = ?","params":[8,8,0,"completed",null,"2025-06-05 22:24:44","4"],"duration_ms":45.68,"rows_affected":1}
[2025-06-05 22:24:44] INFO: Sync completed {"log_id":"4","status":"completed","stats":{"accounts_synced":8,"campaigns_synced":0,"adsets_synced":0,"ads_synced":0,"costs_synced":0,"errors":0}}
[2025-06-05 22:24:44] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.88,"rows_affected":8}
[2025-06-05 22:24:44] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.51,"rows_affected":1}
[2025-06-05 22:24:44] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.69,"rows_affected":1}
[2025-06-05 22:24:50] DEBUG: Database connection established 
[2025-06-05 22:24:50] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1214313446330764"],"duration_ms":44.53,"rows_affected":1}
[2025-06-05 22:24:50] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1214313446330764"],"duration_ms":46.31,"rows_affected":0}
[2025-06-05 22:24:55] DEBUG: Database connection established 
[2025-06-05 22:24:55] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":47.53,"rows_affected":8}
[2025-06-05 22:24:55] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.19,"rows_affected":1}
[2025-06-05 22:24:55] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.06,"rows_affected":1}
[2025-06-05 22:24:59] DEBUG: Database connection established 
[2025-06-05 22:24:59] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":44.98,"rows_affected":1}
[2025-06-05 22:24:59] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.85,"rows_affected":4}
[2025-06-05 22:25:04] DEBUG: Database connection established 
[2025-06-05 22:25:04] DEBUG: Query executed {"sql":"INSERT INTO sync_logs (sync_type, sync_date, status, started_at) VALUES (?, ?, ?, ?)","params":["facebook","2025-06-05 22:25:04","running","2025-06-05 22:25:04"],"duration_ms":45.58,"rows_affected":1}
[2025-06-05 22:25:04] INFO: Sync started {"type":"facebook","log_id":"5"}
[2025-06-05 22:25:04] INFO: Fetching campaigns {"account_id":"act_1370588717662780"}
[2025-06-05 22:25:05] INFO: API Call to Facebook {"endpoint":"\/act_1370588717662780\/campaigns","params":{"method":"GET","params":{"fields":"id,name,status,objective,created_time,updated_time,daily_budget,lifetime_budget","limit":500,"filtering":"[{\"field\":\"effective_status\",\"operator\":\"IN\",\"value\":[\"ACTIVE\",\"PAUSED\",\"PENDING_REVIEW\",\"DISAPPROVED\",\"PREAPPROVED\"]}]","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":451.43,"response_size":8630}
[2025-06-05 22:25:05] INFO: Campaigns fetched {"account_id":"act_1370588717662780","count":34}
[2025-06-05 22:25:05] INFO: Starting campaign sync {"account_id":"act_1370588717662780","campaigns_found":34,"sync_costs":true,"days_back":7}
[2025-06-05 22:25:05] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224733492130185","act_1370588717662780","BarxBuddy US LP 1","ACTIVE"],"duration_ms":45.52,"rows_affected":2}
[2025-06-05 22:25:05] DEBUG: Fetching adsets {"campaign_id":"120224733492130185"}
[2025-06-05 22:25:05] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":283.38,"response_size":879}
[2025-06-05 22:25:05] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734772340185","120224733492130185","ADSET 003","ACTIVE"],"duration_ms":46.19,"rows_affected":2}
[2025-06-05 22:25:05] DEBUG: Fetching ads {"adset_id":"120224734772340185"}
[2025-06-05 22:25:05] INFO: API Call to Facebook {"endpoint":"\/120224734772340185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":288.81,"response_size":547}
[2025-06-05 22:25:05] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734772330185","120224734772340185","120224733492130185","ADSET003-AD001","ACTIVE"],"duration_ms":46.53,"rows_affected":2}
[2025-06-05 22:25:05] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734451540185","120224733492130185","ADSET 002","ACTIVE"],"duration_ms":45.37,"rows_affected":2}
[2025-06-05 22:25:05] DEBUG: Fetching ads {"adset_id":"120224734451540185"}
[2025-06-05 22:25:06] INFO: API Call to Facebook {"endpoint":"\/120224734451540185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":295.22,"response_size":543}
[2025-06-05 22:25:06] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224734451530185","120224734451540185","120224733492130185","ADSET002-AD001","ACTIVE"],"duration_ms":45.29,"rows_affected":2}
[2025-06-05 22:25:06] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224733492230185","120224733492130185","ADSET 001","PAUSED"],"duration_ms":45.87,"rows_affected":2}
[2025-06-05 22:25:06] DEBUG: Fetching ads {"adset_id":"120224733492230185"}
[2025-06-05 22:25:06] INFO: API Call to Facebook {"endpoint":"\/120224733492230185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":282.54,"response_size":549}
[2025-06-05 22:25:06] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120224733492390185","120224733492230185","120224733492130185","ADSET001-AD001","ACTIVE"],"duration_ms":45.56,"rows_affected":2}
[2025-06-05 22:25:06] INFO: Syncing campaign costs {"campaign_id":"120224733492130185","start_date":"2025-05-29","end_date":"2025-06-05"}
[2025-06-05 22:25:06] DEBUG: Fetching insights {"object_id":"120224733492130185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:06] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":382.21,"response_size":707}
[2025-06-05 22:25:06] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",52.87,684,43,"2025-06-02"],"duration_ms":47.16,"rows_affected":2}
[2025-06-05 22:25:06] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-02","spend":52.87,"impressions":684,"clicks":43}
[2025-06-05 22:25:06] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",56.44,780,36,"2025-06-03"],"duration_ms":45.6,"rows_affected":2}
[2025-06-05 22:25:06] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-03","spend":56.44,"impressions":780,"clicks":36}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",66.61,986,48,"2025-06-04"],"duration_ms":45.37,"rows_affected":2}
[2025-06-05 22:25:07] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-04","spend":66.61,"impressions":986,"clicks":48}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",41.25,643,43,"2025-06-05"],"duration_ms":45.23,"rows_affected":2}
[2025-06-05 22:25:07] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-05","spend":41.25,"impressions":643,"clicks":43}
[2025-06-05 22:25:07] INFO: Campaign level costs synced {"campaign_id":"120224733492130185","insights_count":4}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":45,"rows_affected":3}
[2025-06-05 22:25:07] INFO: Syncing adset costs {"campaign_id":"120224733492130185","adsets_count":3}
[2025-06-05 22:25:07] DEBUG: Fetching insights {"object_id":"120224733492230185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:07] INFO: API Call to Facebook {"endpoint":"\/120224733492230185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":410.76,"response_size":548}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",17.19,233,20,"2025-06-02"],"duration_ms":45.87,"rows_affected":2}
[2025-06-05 22:25:07] DEBUG: Cost data saved {"entity_id":"120224733492230185","entity_type":"adset","date":"2025-06-02","spend":17.19,"impressions":233,"clicks":20}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",18.18,313,8,"2025-06-03"],"duration_ms":45.32,"rows_affected":2}
[2025-06-05 22:25:07] DEBUG: Cost data saved {"entity_id":"120224733492230185","entity_type":"adset","date":"2025-06-03","spend":18.18,"impressions":313,"clicks":8}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",21.77,345,15,"2025-06-04"],"duration_ms":45.15,"rows_affected":2}
[2025-06-05 22:25:07] DEBUG: Cost data saved {"entity_id":"120224733492230185","entity_type":"adset","date":"2025-06-04","spend":21.77,"impressions":345,"clicks":15}
[2025-06-05 22:25:07] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120224733492230185"],"duration_ms":45.3,"rows_affected":1}
[2025-06-05 22:25:07] INFO: Syncing ad costs for adset {"adset_id":"120224733492230185","ads_count":1}
[2025-06-05 22:25:07] DEBUG: Fetching insights {"object_id":"120224733492390185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:08] INFO: API Call to Facebook {"endpoint":"\/120224733492390185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":415.7,"response_size":548}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",17.19,233,20,"2025-06-02"],"duration_ms":45.74,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224733492390185","entity_type":"ad","date":"2025-06-02","spend":17.19,"impressions":233,"clicks":20}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",18.18,313,8,"2025-06-03"],"duration_ms":45.35,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224733492390185","entity_type":"ad","date":"2025-06-03","spend":18.18,"impressions":313,"clicks":8}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",21.77,345,15,"2025-06-04"],"duration_ms":45.58,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224733492390185","entity_type":"ad","date":"2025-06-04","spend":21.77,"impressions":345,"clicks":15}
[2025-06-05 22:25:08] DEBUG: Fetching insights {"object_id":"120224734451540185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:08] INFO: API Call to Facebook {"endpoint":"\/120224734451540185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":440.29,"response_size":708}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",18.49,193,13,"2025-06-02"],"duration_ms":45.64,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-02","spend":18.49,"impressions":193,"clicks":13}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",18.67,228,16,"2025-06-03"],"duration_ms":45.44,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-03","spend":18.67,"impressions":228,"clicks":16}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",22.71,327,21,"2025-06-04"],"duration_ms":45.3,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-04","spend":22.71,"impressions":327,"clicks":21}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",19.66,351,22,"2025-06-05"],"duration_ms":45.23,"rows_affected":2}
[2025-06-05 22:25:08] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-05","spend":19.66,"impressions":351,"clicks":22}
[2025-06-05 22:25:08] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120224734451540185"],"duration_ms":45.19,"rows_affected":1}
[2025-06-05 22:25:08] INFO: Syncing ad costs for adset {"adset_id":"120224734451540185","ads_count":1}
[2025-06-05 22:25:08] DEBUG: Fetching insights {"object_id":"120224734451530185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:09] INFO: API Call to Facebook {"endpoint":"\/120224734451530185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":421.79,"response_size":708}
[2025-06-05 22:25:09] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",18.49,193,13,"2025-06-02"],"duration_ms":45.64,"rows_affected":2}
[2025-06-05 22:25:09] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-02","spend":18.49,"impressions":193,"clicks":13}
[2025-06-05 22:25:09] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",18.67,228,16,"2025-06-03"],"duration_ms":45.66,"rows_affected":2}
[2025-06-05 22:25:09] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-03","spend":18.67,"impressions":228,"clicks":16}
[2025-06-05 22:25:09] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",22.71,327,21,"2025-06-04"],"duration_ms":45.6,"rows_affected":2}
[2025-06-05 22:25:09] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-04","spend":22.71,"impressions":327,"clicks":21}
[2025-06-05 22:25:09] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",19.66,351,22,"2025-06-05"],"duration_ms":45.77,"rows_affected":2}
[2025-06-05 22:25:09] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-05","spend":19.66,"impressions":351,"clicks":22}
[2025-06-05 22:25:09] DEBUG: Fetching insights {"object_id":"120224734772340185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:10] INFO: API Call to Facebook {"endpoint":"\/120224734772340185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":496.08,"response_size":703}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",17.19,258,10,"2025-06-02"],"duration_ms":45.48,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-02","spend":17.19,"impressions":258,"clicks":10}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",19.59,239,12,"2025-06-03"],"duration_ms":45.93,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-03","spend":19.59,"impressions":239,"clicks":12}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",22.13,314,12,"2025-06-04"],"duration_ms":45.71,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-04","spend":22.13,"impressions":314,"clicks":12}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",21.59,292,21,"2025-06-05"],"duration_ms":45.78,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-05","spend":21.59,"impressions":292,"clicks":21}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120224734772340185"],"duration_ms":45.61,"rows_affected":1}
[2025-06-05 22:25:10] INFO: Syncing ad costs for adset {"adset_id":"120224734772340185","ads_count":1}
[2025-06-05 22:25:10] DEBUG: Fetching insights {"object_id":"120224734772330185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:10] INFO: API Call to Facebook {"endpoint":"\/120224734772330185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":407.97,"response_size":703}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",17.19,258,10,"2025-06-02"],"duration_ms":46.05,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-02","spend":17.19,"impressions":258,"clicks":10}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",19.59,239,12,"2025-06-03"],"duration_ms":45.42,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-03","spend":19.59,"impressions":239,"clicks":12}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",22.13,314,12,"2025-06-04"],"duration_ms":45.71,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-04","spend":22.13,"impressions":314,"clicks":12}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",21.59,292,21,"2025-06-05"],"duration_ms":46.03,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-05","spend":21.59,"impressions":292,"clicks":21}
[2025-06-05 22:25:10] INFO: Campaign costs sync completed {"campaign_id":"120224733492130185","costs_synced":26}
[2025-06-05 22:25:10] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219270573570185","act_1370588717662780","SANDBOX | WELLAMOON | Abierta","PAUSED"],"duration_ms":45.5,"rows_affected":2}
[2025-06-05 22:25:10] DEBUG: Fetching adsets {"campaign_id":"120219270573570185"}
[2025-06-05 22:25:11] INFO: API Call to Facebook {"endpoint":"\/120219270573570185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":266.5,"response_size":550}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON","ACTIVE"],"duration_ms":45.61,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Fetching ads {"adset_id":"120219270573580185"}
[2025-06-05 22:25:11] INFO: API Call to Facebook {"endpoint":"\/120219270573580185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":313.14,"response_size":5640}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283907700185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | OFF | CR-2 | TP-5 | TT-8 | LP-8 | Ad14","PAUSED"],"duration_ms":46.12,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847600185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-4 | TT-7 | LP-8 | Ad2","ACTIVE"],"duration_ms":45.67,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847500185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-4 | TT-7 | LP-8 | Ad3","ACTIVE"],"duration_ms":45.44,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283683460185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-4 | TT-8 | LP-8 | Ad11","ACTIVE"],"duration_ms":45.29,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847620185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-5 | TT-7 | LP-8 | Ad6","ACTIVE"],"duration_ms":45.42,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847530185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-6 | TT-7 | LP-8 | Ad9","ACTIVE"],"duration_ms":45.14,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847510185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-5 | TT-7 | LP-8 | Ad5","ACTIVE"],"duration_ms":45,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847610185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-5 | TT-7 | LP-8 | Ad4","ACTIVE"],"duration_ms":46.2,"rows_affected":2}
[2025-06-05 22:25:11] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283907690185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-5 | TT-8 | LP-8 | Ad13","ACTIVE"],"duration_ms":45.11,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283683470185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-4 | TT-8 | LP-8 | Ad10","ACTIVE"],"duration_ms":45.47,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283907680185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-5 | TT-8 | LP-8 | Ad15","ACTIVE"],"duration_ms":45.31,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219284028810185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-6 | TT-8 | LP-8 | Ad16","ACTIVE"],"duration_ms":45.64,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847630185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-6 | TT-7 | LP-8 | Ad8","ACTIVE"],"duration_ms":45.53,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219283683450185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-4 | TT-8 | LP-8 | Ad12","ACTIVE"],"duration_ms":45.84,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219284028820185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-2 | TP-6 | TT-8 | LP-8 | Ad17","ACTIVE"],"duration_ms":45.48,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219281847520185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-6 | TT-7 | LP-8 | Ad7","ACTIVE"],"duration_ms":45.14,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219284028830185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-3 | TP-6 | TT-8 | LP-8 | Ad18","ACTIVE"],"duration_ms":45.45,"rows_affected":2}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120219270573600185","120219270573580185","120219270573570185","SANDBOX | WELLAMOON | Abierta | Adset1 | TMV | ON | ON | CR-1 | TP-4 | TT-7 | LP-8","ACTIVE"],"duration_ms":45.34,"rows_affected":2}
[2025-06-05 22:25:12] INFO: Syncing campaign costs {"campaign_id":"120219270573570185","start_date":"2025-05-29","end_date":"2025-06-05"}
[2025-06-05 22:25:12] DEBUG: Fetching insights {"object_id":"120219270573570185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:12] INFO: API Call to Facebook {"endpoint":"\/120219270573570185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":373.88,"response_size":31}
[2025-06-05 22:25:12] INFO: Campaign level costs synced {"campaign_id":"120219270573570185","insights_count":0}
[2025-06-05 22:25:12] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120219270573570185"],"duration_ms":45.44,"rows_affected":1}
[2025-06-05 22:25:12] INFO: Syncing adset costs {"campaign_id":"120219270573570185","adsets_count":1}
[2025-06-05 22:25:12] DEBUG: Fetching insights {"object_id":"120219270573580185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:13] INFO: API Call to Facebook {"endpoint":"\/120219270573580185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":406.46,"response_size":31}
[2025-06-05 22:25:13] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120219270573580185"],"duration_ms":45.38,"rows_affected":18}
[2025-06-05 22:25:13] INFO: Syncing ad costs for adset {"adset_id":"120219270573580185","ads_count":18}
[2025-06-05 22:25:13] DEBUG: Fetching insights {"object_id":"120219270573600185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:13] INFO: API Call to Facebook {"endpoint":"\/120219270573600185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":372.26,"response_size":31}
[2025-06-05 22:25:13] DEBUG: Fetching insights {"object_id":"120219281847500185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:14] INFO: API Call to Facebook {"endpoint":"\/120219281847500185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":373.49,"response_size":31}
[2025-06-05 22:25:14] DEBUG: Fetching insights {"object_id":"120219281847510185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:14] INFO: API Call to Facebook {"endpoint":"\/120219281847510185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":428.97,"response_size":31}
[2025-06-05 22:25:14] DEBUG: Fetching insights {"object_id":"120219281847520185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:14] INFO: API Call to Facebook {"endpoint":"\/120219281847520185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":321.35,"response_size":31}
[2025-06-05 22:25:14] DEBUG: Fetching insights {"object_id":"120219281847530185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:15] INFO: API Call to Facebook {"endpoint":"\/120219281847530185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":468.67,"response_size":31}
[2025-06-05 22:25:15] DEBUG: Fetching insights {"object_id":"120219281847600185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:15] INFO: API Call to Facebook {"endpoint":"\/120219281847600185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":406.53,"response_size":31}
[2025-06-05 22:25:15] DEBUG: Fetching insights {"object_id":"120219281847610185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:16] INFO: API Call to Facebook {"endpoint":"\/120219281847610185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":574.67,"response_size":31}
[2025-06-05 22:25:16] DEBUG: Fetching insights {"object_id":"120219281847620185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:16] INFO: API Call to Facebook {"endpoint":"\/120219281847620185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":380.46,"response_size":31}
[2025-06-05 22:25:16] DEBUG: Fetching insights {"object_id":"120219281847630185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:16] INFO: API Call to Facebook {"endpoint":"\/120219281847630185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":381.21,"response_size":31}
[2025-06-05 22:25:16] DEBUG: Fetching insights {"object_id":"120219283683450185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:17] INFO: API Call to Facebook {"endpoint":"\/120219283683450185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":375.91,"response_size":31}
[2025-06-05 22:25:17] DEBUG: Fetching insights {"object_id":"120219283683460185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:17] INFO: API Call to Facebook {"endpoint":"\/120219283683460185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":403.84,"response_size":31}
[2025-06-05 22:25:17] DEBUG: Fetching insights {"object_id":"120219283683470185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:18] INFO: API Call to Facebook {"endpoint":"\/120219283683470185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":316.17,"response_size":31}
[2025-06-05 22:25:18] DEBUG: Fetching insights {"object_id":"120219283907680185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:18] INFO: API Call to Facebook {"endpoint":"\/120219283907680185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":545.77,"response_size":31}
[2025-06-05 22:25:18] DEBUG: Fetching insights {"object_id":"120219283907690185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:18] INFO: API Call to Facebook {"endpoint":"\/120219283907690185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":372.79,"response_size":31}
[2025-06-05 22:25:18] DEBUG: Fetching insights {"object_id":"120219283907700185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:19] INFO: API Call to Facebook {"endpoint":"\/120219283907700185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":390.32,"response_size":31}
[2025-06-05 22:25:19] DEBUG: Fetching insights {"object_id":"120219284028810185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:19] INFO: API Call to Facebook {"endpoint":"\/120219284028810185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":369.64,"response_size":31}
[2025-06-05 22:25:19] DEBUG: Fetching insights {"object_id":"120219284028820185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:20] INFO: API Call to Facebook {"endpoint":"\/120219284028820185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":349.09,"response_size":31}
[2025-06-05 22:25:20] DEBUG: Fetching insights {"object_id":"120219284028830185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:20] INFO: API Call to Facebook {"endpoint":"\/120219284028830185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":467.99,"response_size":31}
[2025-06-05 22:25:20] INFO: Campaign costs sync completed {"campaign_id":"120219270573570185","costs_synced":26}
[2025-06-05 22:25:20] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217274349160185","act_1370588717662780","Wellamoon Testing ADV 3-4-5-6","PAUSED"],"duration_ms":45.59,"rows_affected":2}
[2025-06-05 22:25:20] DEBUG: Fetching adsets {"campaign_id":"120217274349160185"}
[2025-06-05 22:25:20] INFO: API Call to Facebook {"endpoint":"\/120217274349160185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":306.24,"response_size":2145}
[2025-06-05 22:25:20] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218210593890185","120217274349160185","Wellamoon Testing IMG003_ADV6","PAUSED"],"duration_ms":45.62,"rows_affected":2}
[2025-06-05 22:25:20] DEBUG: Fetching ads {"adset_id":"120218210593890185"}
[2025-06-05 22:25:21] INFO: API Call to Facebook {"endpoint":"\/120218210593890185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":323.55,"response_size":556}
[2025-06-05 22:25:21] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218210593880185","120218210593890185","120217274349160185","Wellamoon Testing IMG003_ADV6","ACTIVE"],"duration_ms":45.27,"rows_affected":2}
[2025-06-05 22:25:21] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218209793850185","120217274349160185","Wellamoon Testing IMG003_ADV5","ACTIVE"],"duration_ms":45.41,"rows_affected":2}
[2025-06-05 22:25:21] DEBUG: Fetching ads {"adset_id":"120218209793850185"}
[2025-06-05 22:25:21] INFO: API Call to Facebook {"endpoint":"\/120218209793850185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":270.63,"response_size":554}
[2025-06-05 22:25:21] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218209793840185","120218209793850185","120217274349160185","Wellamoon Testing IMG003_ADV5","ACTIVE"],"duration_ms":45.55,"rows_affected":2}
[2025-06-05 22:25:21] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218208572860185","120217274349160185","Wellamoon Testing IMG003_ADV4","ACTIVE"],"duration_ms":45.46,"rows_affected":2}
[2025-06-05 22:25:21] DEBUG: Fetching ads {"adset_id":"120218208572860185"}
[2025-06-05 22:25:22] INFO: API Call to Facebook {"endpoint":"\/120218208572860185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":467.54,"response_size":560}
[2025-06-05 22:25:22] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218208572870185","120218208572860185","120217274349160185","Wellamoon Testing IMG003_ADV4","ACTIVE"],"duration_ms":45.49,"rows_affected":2}
[2025-06-05 22:25:22] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218013123980185","120217274349160185","Wellamoon Testing 05_ADV6","PAUSED"],"duration_ms":45.71,"rows_affected":2}
[2025-06-05 22:25:22] DEBUG: Fetching ads {"adset_id":"120218013123980185"}
[2025-06-05 22:25:22] INFO: API Call to Facebook {"endpoint":"\/120218013123980185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":318.56,"response_size":556}
[2025-06-05 22:25:22] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218013123970185","120218013123980185","120217274349160185","Wellamoon Testing 05_ADV6","ACTIVE"],"duration_ms":45.29,"rows_affected":2}
[2025-06-05 22:25:22] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218012394950185","120217274349160185","Wellamoon Testing 05_ADV5","PAUSED"],"duration_ms":45.34,"rows_affected":2}
[2025-06-05 22:25:22] DEBUG: Fetching ads {"adset_id":"120218012394950185"}
[2025-06-05 22:25:23] INFO: API Call to Facebook {"endpoint":"\/120218012394950185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":351.47,"response_size":552}
[2025-06-05 22:25:23] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218012394940185","120218012394950185","120217274349160185","Wellamoon Testing 05_ADV5","ACTIVE"],"duration_ms":45.51,"rows_affected":2}
[2025-06-05 22:25:23] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218011716430185","120217274349160185","Wellamoon Testing 05_ADV4","PAUSED"],"duration_ms":45.52,"rows_affected":2}
[2025-06-05 22:25:23] DEBUG: Fetching ads {"adset_id":"120218011716430185"}
[2025-06-05 22:25:23] INFO: API Call to Facebook {"endpoint":"\/120218011716430185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":338.31,"response_size":560}
[2025-06-05 22:25:23] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120218011716440185","120218011716430185","120217274349160185","Wellamoon Testing 05_ADV4","ACTIVE"],"duration_ms":44.95,"rows_affected":2}
[2025-06-05 22:25:23] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382348520185","120217274349160185","Wellamoon Testing IMG003_ADV3","ACTIVE"],"duration_ms":45.12,"rows_affected":2}
[2025-06-05 22:25:23] DEBUG: Fetching ads {"adset_id":"120217382348520185"}
[2025-06-05 22:25:23] INFO: API Call to Facebook {"endpoint":"\/120217382348520185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":259.22,"response_size":560}
[2025-06-05 22:25:23] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382348510185","120217382348520185","120217274349160185","Wellamoon Testing IMG003_ADV3","ACTIVE"],"duration_ms":45.35,"rows_affected":2}
[2025-06-05 22:25:23] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382155840185","120217274349160185","Wellamoon Testing IMG001_ADV3","PAUSED"],"duration_ms":45.55,"rows_affected":2}
[2025-06-05 22:25:23] DEBUG: Fetching ads {"adset_id":"120217382155840185"}
[2025-06-05 22:25:24] INFO: API Call to Facebook {"endpoint":"\/120217382155840185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":313.11,"response_size":556}
[2025-06-05 22:25:24] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217382155830185","120217382155840185","120217274349160185","Wellamoon Testing IMG001_ADV3","ACTIVE"],"duration_ms":45.6,"rows_affected":2}
[2025-06-05 22:25:24] DEBUG: Query executed {"sql":"INSERT INTO adsets (id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217274349150185","120217274349160185","Wellamoon Testing 05_ADV3","PAUSED"],"duration_ms":45.3,"rows_affected":2}
[2025-06-05 22:25:24] DEBUG: Fetching ads {"adset_id":"120217274349150185"}
[2025-06-05 22:25:24] INFO: API Call to Facebook {"endpoint":"\/120217274349150185\/ads","params":{"method":"GET","params":{"fields":"id,name,status,adset_id,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":294.62,"response_size":558}
[2025-06-05 22:25:24] DEBUG: Query executed {"sql":"INSERT INTO ads (id, adset_id, campaign_id, name, status) \n                    VALUES (?, ?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217274349170185","120217274349150185","120217274349160185","Wellamoon Testing 05_ADV3","ACTIVE"],"duration_ms":45.14,"rows_affected":2}
[2025-06-05 22:25:24] INFO: Syncing campaign costs {"campaign_id":"120217274349160185","start_date":"2025-05-29","end_date":"2025-06-05"}
[2025-06-05 22:25:24] DEBUG: Fetching insights {"object_id":"120217274349160185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:25] INFO: API Call to Facebook {"endpoint":"\/120217274349160185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":395.36,"response_size":31}
[2025-06-05 22:25:25] INFO: Campaign level costs synced {"campaign_id":"120217274349160185","insights_count":0}
[2025-06-05 22:25:25] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120217274349160185"],"duration_ms":45.58,"rows_affected":9}
[2025-06-05 22:25:25] INFO: Syncing adset costs {"campaign_id":"120217274349160185","adsets_count":9}
[2025-06-05 22:25:25] DEBUG: Fetching insights {"object_id":"120217274349150185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:25] INFO: API Call to Facebook {"endpoint":"\/120217274349150185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":398.23,"response_size":31}
[2025-06-05 22:25:25] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120217274349150185"],"duration_ms":45.76,"rows_affected":1}
[2025-06-05 22:25:25] INFO: Syncing ad costs for adset {"adset_id":"120217274349150185","ads_count":1}
[2025-06-05 22:25:25] DEBUG: Fetching insights {"object_id":"120217274349170185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:25] INFO: API Call to Facebook {"endpoint":"\/120217274349170185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":358.89,"response_size":31}
[2025-06-05 22:25:25] DEBUG: Fetching insights {"object_id":"120217382155840185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:26] INFO: API Call to Facebook {"endpoint":"\/120217382155840185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":403.42,"response_size":31}
[2025-06-05 22:25:26] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120217382155840185"],"duration_ms":45.71,"rows_affected":1}
[2025-06-05 22:25:26] INFO: Syncing ad costs for adset {"adset_id":"120217382155840185","ads_count":1}
[2025-06-05 22:25:26] DEBUG: Fetching insights {"object_id":"120217382155830185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:26] INFO: API Call to Facebook {"endpoint":"\/120217382155830185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":429.99,"response_size":31}
[2025-06-05 22:25:26] DEBUG: Fetching insights {"object_id":"120217382348520185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:27] INFO: API Call to Facebook {"endpoint":"\/120217382348520185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":308.94,"response_size":31}
[2025-06-05 22:25:27] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120217382348520185"],"duration_ms":45.71,"rows_affected":1}
[2025-06-05 22:25:27] INFO: Syncing ad costs for adset {"adset_id":"120217382348520185","ads_count":1}
[2025-06-05 22:25:27] DEBUG: Fetching insights {"object_id":"120217382348510185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:27] INFO: API Call to Facebook {"endpoint":"\/120217382348510185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":449.33,"response_size":31}
[2025-06-05 22:25:27] DEBUG: Fetching insights {"object_id":"120218011716430185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:28] INFO: API Call to Facebook {"endpoint":"\/120218011716430185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":350.03,"response_size":31}
[2025-06-05 22:25:28] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120218011716430185"],"duration_ms":45.44,"rows_affected":1}
[2025-06-05 22:25:28] INFO: Syncing ad costs for adset {"adset_id":"120218011716430185","ads_count":1}
[2025-06-05 22:25:28] DEBUG: Fetching insights {"object_id":"120218011716440185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:28] INFO: API Call to Facebook {"endpoint":"\/120218011716440185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":412.19,"response_size":31}
[2025-06-05 22:25:28] DEBUG: Fetching insights {"object_id":"120218012394950185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:28] INFO: API Call to Facebook {"endpoint":"\/120218012394950185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":410.37,"response_size":31}
[2025-06-05 22:25:28] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120218012394950185"],"duration_ms":46.27,"rows_affected":1}
[2025-06-05 22:25:28] INFO: Syncing ad costs for adset {"adset_id":"120218012394950185","ads_count":1}
[2025-06-05 22:25:28] DEBUG: Fetching insights {"object_id":"120218012394940185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:29] INFO: API Call to Facebook {"endpoint":"\/120218012394940185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":366.07,"response_size":31}
[2025-06-05 22:25:29] DEBUG: Fetching insights {"object_id":"120218013123980185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:29] INFO: API Call to Facebook {"endpoint":"\/120218013123980185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":315.2,"response_size":31}
[2025-06-05 22:25:29] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120218013123980185"],"duration_ms":45.8,"rows_affected":1}
[2025-06-05 22:25:29] INFO: Syncing ad costs for adset {"adset_id":"120218013123980185","ads_count":1}
[2025-06-05 22:25:29] DEBUG: Fetching insights {"object_id":"120218013123970185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:30] INFO: API Call to Facebook {"endpoint":"\/120218013123970185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":391.12,"response_size":31}
[2025-06-05 22:25:30] DEBUG: Fetching insights {"object_id":"120218208572860185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:30] INFO: API Call to Facebook {"endpoint":"\/120218208572860185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":372.63,"response_size":31}
[2025-06-05 22:25:30] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120218208572860185"],"duration_ms":45.73,"rows_affected":1}
[2025-06-05 22:25:30] INFO: Syncing ad costs for adset {"adset_id":"120218208572860185","ads_count":1}
[2025-06-05 22:25:30] DEBUG: Fetching insights {"object_id":"120218208572870185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:30] INFO: API Call to Facebook {"endpoint":"\/120218208572870185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":371.5,"response_size":31}
[2025-06-05 22:25:30] DEBUG: Fetching insights {"object_id":"120218209793850185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:31] INFO: API Call to Facebook {"endpoint":"\/120218209793850185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":360.36,"response_size":31}
[2025-06-05 22:25:31] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120218209793850185"],"duration_ms":45.78,"rows_affected":1}
[2025-06-05 22:25:31] INFO: Syncing ad costs for adset {"adset_id":"120218209793850185","ads_count":1}
[2025-06-05 22:25:31] DEBUG: Fetching insights {"object_id":"120218209793840185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:31] INFO: API Call to Facebook {"endpoint":"\/120218209793840185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":367.81,"response_size":31}
[2025-06-05 22:25:31] DEBUG: Fetching insights {"object_id":"120218210593890185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:31] INFO: API Call to Facebook {"endpoint":"\/120218210593890185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":343.39,"response_size":31}
[2025-06-05 22:25:32] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120218210593890185"],"duration_ms":45.55,"rows_affected":1}
[2025-06-05 22:25:32] INFO: Syncing ad costs for adset {"adset_id":"120218210593890185","ads_count":1}
[2025-06-05 22:25:32] DEBUG: Fetching insights {"object_id":"120218210593880185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:25:32] INFO: API Call to Facebook {"endpoint":"\/120218210593880185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":585.82,"response_size":31}
[2025-06-05 22:25:32] INFO: Campaign costs sync completed {"campaign_id":"120217274349160185","costs_synced":26}
[2025-06-05 22:25:32] DEBUG: Query executed {"sql":"INSERT INTO campaigns (id, account_id, name, status) \n                    VALUES (?, ?, ?, ?)\n                    ON DUPLICATE KEY UPDATE\n                        account_id = VALUES(account_id),\n                        name = VALUES(name),\n                        status = VALUES(status),\n                        updated_at = CURRENT_TIMESTAMP","params":["120217273798940185","act_1370588717662780","Wellamoon Testing ADV 2","PAUSED"],"duration_ms":45.83,"rows_affected":2}
[2025-06-05 22:25:32] DEBUG: Fetching adsets {"campaign_id":"120217273798940185"}
[2025-06-05 22:25:33] INFO: API Call to Facebook {"endpoint":"\/120217273798940185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":362.92,"response_size":400}
[2025-06-05 22:25:33] WARNING: Facebook API rate limit hit {"endpoint":"\/120217273798940185\/adsets","attempt":1}
[2025-06-05 22:25:34] INFO: API Call to Facebook {"endpoint":"\/120217273798940185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":274.28,"response_size":400}
[2025-06-05 22:25:34] WARNING: Facebook API rate limit hit {"endpoint":"\/120217273798940185\/adsets","attempt":2}
[2025-06-05 22:25:36] INFO: API Call to Facebook {"endpoint":"\/120217273798940185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":280.88,"response_size":400}
[2025-06-05 22:25:36] WARNING: Facebook API rate limit hit {"endpoint":"\/120217273798940185\/adsets","attempt":3}
[2025-06-05 22:25:36] ERROR: Facebook API request failed {"endpoint":"\/120217273798940185\/adsets","attempt":3,"error":"User request limit reached"}
[2025-06-05 22:25:36] ERROR: Failed to sync campaign structure {"campaign_id":"120217273798940185","error":"User request limit reached"}
[2025-06-05 22:25:36] ERROR: Sync account campaigns failed {"account_id":"act_1370588717662780","error":"User request limit reached"}
[2025-06-05 22:25:36] DEBUG: Query executed {"sql":"UPDATE sync_logs SET records_processed = ?, records_created = ?, records_updated = ?, status = ?, error_message = ?, completed_at = ? WHERE id = ?","params":[73,73,0,"failed","User request limit reached","2025-06-05 22:25:36","5"],"duration_ms":45.75,"rows_affected":1}
[2025-06-05 22:25:36] INFO: Sync completed {"log_id":"5","status":"failed","stats":{"accounts_synced":0,"campaigns_synced":4,"adsets_synced":13,"ads_synced":30,"costs_synced":26,"errors":0}}
[2025-06-05 22:25:36] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":45.02,"rows_affected":1}
[2025-06-05 22:25:36] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.09,"rows_affected":4}
[2025-06-05 22:27:30] DEBUG: Database connection established 
[2025-06-05 22:27:30] DEBUG: Fetching adsets {"campaign_id":"120224733492130185"}
[2025-06-05 22:27:30] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":701.54,"response_size":400}
[2025-06-05 22:27:30] WARNING: Facebook API rate limit hit {"endpoint":"\/120224733492130185\/adsets","attempt":1}
[2025-06-05 22:27:32] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":554.36,"response_size":400}
[2025-06-05 22:27:32] WARNING: Facebook API rate limit hit {"endpoint":"\/120224733492130185\/adsets","attempt":2}
[2025-06-05 22:27:34] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/adsets","params":{"method":"GET","params":{"fields":"id,name,status,campaign_id,created_time,updated_time","limit":500,"access_token":"EAATjAbHDt..."}},"response_code":400,"duration_ms":529.28,"response_size":400}
[2025-06-05 22:27:34] WARNING: Facebook API rate limit hit {"endpoint":"\/120224733492130185\/adsets","attempt":3}
[2025-06-05 22:27:34] ERROR: Facebook API request failed {"endpoint":"\/120224733492130185\/adsets","attempt":3,"error":"User request limit reached"}
[2025-06-05 22:27:34] ERROR: Failed to sync campaign structure {"campaign_id":"120224733492130185","error":"User request limit reached"}
[2025-06-05 22:27:34] INFO: Syncing campaign costs {"campaign_id":"120224733492130185","start_date":"2025-05-29","end_date":"2025-06-05"}
[2025-06-05 22:27:34] DEBUG: Fetching insights {"object_id":"120224733492130185","level":"campaign","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:35] INFO: API Call to Facebook {"endpoint":"\/120224733492130185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"campaign","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":648.73,"response_size":707}
[2025-06-05 22:27:35] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",52.87,684,43,"2025-06-02"],"duration_ms":45.65,"rows_affected":2}
[2025-06-05 22:27:35] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-02","spend":52.87,"impressions":684,"clicks":43}
[2025-06-05 22:27:35] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",56.44,780,36,"2025-06-03"],"duration_ms":44.49,"rows_affected":2}
[2025-06-05 22:27:35] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-03","spend":56.44,"impressions":780,"clicks":36}
[2025-06-05 22:27:35] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",66.61,986,48,"2025-06-04"],"duration_ms":45.31,"rows_affected":2}
[2025-06-05 22:27:35] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-04","spend":66.61,"impressions":986,"clicks":48}
[2025-06-05 22:27:35] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492130185","campaign",41.25,643,43,"2025-06-05"],"duration_ms":44.88,"rows_affected":2}
[2025-06-05 22:27:35] DEBUG: Cost data saved {"entity_id":"120224733492130185","entity_type":"campaign","date":"2025-06-05","spend":41.25,"impressions":643,"clicks":43}
[2025-06-05 22:27:35] INFO: Campaign level costs synced {"campaign_id":"120224733492130185","insights_count":4}
[2025-06-05 22:27:35] DEBUG: Query executed {"sql":"SELECT id FROM adsets WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":44.41,"rows_affected":3}
[2025-06-05 22:27:35] INFO: Syncing adset costs {"campaign_id":"120224733492130185","adsets_count":3}
[2025-06-05 22:27:35] DEBUG: Fetching insights {"object_id":"120224733492230185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:36] INFO: API Call to Facebook {"endpoint":"\/120224733492230185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":788.74,"response_size":548}
[2025-06-05 22:27:36] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",17.19,233,20,"2025-06-02"],"duration_ms":44.99,"rows_affected":2}
[2025-06-05 22:27:36] DEBUG: Cost data saved {"entity_id":"120224733492230185","entity_type":"adset","date":"2025-06-02","spend":17.19,"impressions":233,"clicks":20}
[2025-06-05 22:27:36] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",18.18,313,8,"2025-06-03"],"duration_ms":44.5,"rows_affected":2}
[2025-06-05 22:27:36] DEBUG: Cost data saved {"entity_id":"120224733492230185","entity_type":"adset","date":"2025-06-03","spend":18.18,"impressions":313,"clicks":8}
[2025-06-05 22:27:36] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492230185","adset",21.77,345,15,"2025-06-04"],"duration_ms":44.32,"rows_affected":2}
[2025-06-05 22:27:36] DEBUG: Cost data saved {"entity_id":"120224733492230185","entity_type":"adset","date":"2025-06-04","spend":21.77,"impressions":345,"clicks":15}
[2025-06-05 22:27:36] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120224733492230185"],"duration_ms":44.75,"rows_affected":1}
[2025-06-05 22:27:36] INFO: Syncing ad costs for adset {"adset_id":"120224733492230185","ads_count":1}
[2025-06-05 22:27:36] DEBUG: Fetching insights {"object_id":"120224733492390185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:37] INFO: API Call to Facebook {"endpoint":"\/120224733492390185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":656.89,"response_size":548}
[2025-06-05 22:27:37] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",17.19,233,20,"2025-06-02"],"duration_ms":45.03,"rows_affected":2}
[2025-06-05 22:27:37] DEBUG: Cost data saved {"entity_id":"120224733492390185","entity_type":"ad","date":"2025-06-02","spend":17.19,"impressions":233,"clicks":20}
[2025-06-05 22:27:37] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",18.18,313,8,"2025-06-03"],"duration_ms":45.27,"rows_affected":2}
[2025-06-05 22:27:37] DEBUG: Cost data saved {"entity_id":"120224733492390185","entity_type":"ad","date":"2025-06-03","spend":18.18,"impressions":313,"clicks":8}
[2025-06-05 22:27:37] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224733492390185","ad",21.77,345,15,"2025-06-04"],"duration_ms":45.1,"rows_affected":2}
[2025-06-05 22:27:37] DEBUG: Cost data saved {"entity_id":"120224733492390185","entity_type":"ad","date":"2025-06-04","spend":21.77,"impressions":345,"clicks":15}
[2025-06-05 22:27:37] DEBUG: Fetching insights {"object_id":"120224734451540185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:38] INFO: API Call to Facebook {"endpoint":"\/120224734451540185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":789.59,"response_size":708}
[2025-06-05 22:27:38] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",18.49,193,13,"2025-06-02"],"duration_ms":44.98,"rows_affected":2}
[2025-06-05 22:27:38] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-02","spend":18.49,"impressions":193,"clicks":13}
[2025-06-05 22:27:38] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",18.67,228,16,"2025-06-03"],"duration_ms":44.73,"rows_affected":2}
[2025-06-05 22:27:38] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-03","spend":18.67,"impressions":228,"clicks":16}
[2025-06-05 22:27:38] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",22.71,327,21,"2025-06-04"],"duration_ms":45.08,"rows_affected":2}
[2025-06-05 22:27:38] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-04","spend":22.71,"impressions":327,"clicks":21}
[2025-06-05 22:27:38] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451540185","adset",19.66,351,22,"2025-06-05"],"duration_ms":44.75,"rows_affected":2}
[2025-06-05 22:27:38] DEBUG: Cost data saved {"entity_id":"120224734451540185","entity_type":"adset","date":"2025-06-05","spend":19.66,"impressions":351,"clicks":22}
[2025-06-05 22:27:38] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120224734451540185"],"duration_ms":44.84,"rows_affected":1}
[2025-06-05 22:27:38] INFO: Syncing ad costs for adset {"adset_id":"120224734451540185","ads_count":1}
[2025-06-05 22:27:38] DEBUG: Fetching insights {"object_id":"120224734451530185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:39] INFO: API Call to Facebook {"endpoint":"\/120224734451530185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":723.68,"response_size":708}
[2025-06-05 22:27:39] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",18.49,193,13,"2025-06-02"],"duration_ms":44.98,"rows_affected":2}
[2025-06-05 22:27:39] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-02","spend":18.49,"impressions":193,"clicks":13}
[2025-06-05 22:27:39] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",18.67,228,16,"2025-06-03"],"duration_ms":45.07,"rows_affected":2}
[2025-06-05 22:27:39] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-03","spend":18.67,"impressions":228,"clicks":16}
[2025-06-05 22:27:39] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",22.71,327,21,"2025-06-04"],"duration_ms":44.84,"rows_affected":2}
[2025-06-05 22:27:39] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-04","spend":22.71,"impressions":327,"clicks":21}
[2025-06-05 22:27:39] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734451530185","ad",19.66,351,22,"2025-06-05"],"duration_ms":44.89,"rows_affected":2}
[2025-06-05 22:27:39] DEBUG: Cost data saved {"entity_id":"120224734451530185","entity_type":"ad","date":"2025-06-05","spend":19.66,"impressions":351,"clicks":22}
[2025-06-05 22:27:39] DEBUG: Fetching insights {"object_id":"120224734772340185","level":"adset","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:40] INFO: API Call to Facebook {"endpoint":"\/120224734772340185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"adset","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":751.64,"response_size":703}
[2025-06-05 22:27:40] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",17.19,258,10,"2025-06-02"],"duration_ms":45.03,"rows_affected":2}
[2025-06-05 22:27:40] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-02","spend":17.19,"impressions":258,"clicks":10}
[2025-06-05 22:27:40] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",19.59,239,12,"2025-06-03"],"duration_ms":45.04,"rows_affected":2}
[2025-06-05 22:27:40] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-03","spend":19.59,"impressions":239,"clicks":12}
[2025-06-05 22:27:40] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",22.13,314,12,"2025-06-04"],"duration_ms":44.92,"rows_affected":2}
[2025-06-05 22:27:40] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-04","spend":22.13,"impressions":314,"clicks":12}
[2025-06-05 22:27:40] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772340185","adset",21.59,292,21,"2025-06-05"],"duration_ms":44.58,"rows_affected":2}
[2025-06-05 22:27:40] DEBUG: Cost data saved {"entity_id":"120224734772340185","entity_type":"adset","date":"2025-06-05","spend":21.59,"impressions":292,"clicks":21}
[2025-06-05 22:27:40] DEBUG: Query executed {"sql":"SELECT id FROM ads WHERE adset_id = ?","params":["120224734772340185"],"duration_ms":44.52,"rows_affected":1}
[2025-06-05 22:27:40] INFO: Syncing ad costs for adset {"adset_id":"120224734772340185","ads_count":1}
[2025-06-05 22:27:40] DEBUG: Fetching insights {"object_id":"120224734772330185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:41] INFO: API Call to Facebook {"endpoint":"\/120224734772330185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":667.79,"response_size":703}
[2025-06-05 22:27:41] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",17.19,258,10,"2025-06-02"],"duration_ms":44.75,"rows_affected":2}
[2025-06-05 22:27:41] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-02","spend":17.19,"impressions":258,"clicks":10}
[2025-06-05 22:27:41] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",19.59,239,12,"2025-06-03"],"duration_ms":44.9,"rows_affected":2}
[2025-06-05 22:27:41] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-03","spend":19.59,"impressions":239,"clicks":12}
[2025-06-05 22:27:41] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",22.13,314,12,"2025-06-04"],"duration_ms":45.23,"rows_affected":2}
[2025-06-05 22:27:41] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-04","spend":22.13,"impressions":314,"clicks":12}
[2025-06-05 22:27:41] DEBUG: Query executed {"sql":"CALL upsert_facebook_cost(?, ?, ?, ?, ?, ?)","params":["120224734772330185","ad",21.59,292,21,"2025-06-05"],"duration_ms":44.98,"rows_affected":2}
[2025-06-05 22:27:41] DEBUG: Cost data saved {"entity_id":"120224734772330185","entity_type":"ad","date":"2025-06-05","spend":21.59,"impressions":292,"clicks":21}
[2025-06-05 22:27:41] INFO: Campaign costs sync completed {"campaign_id":"120224733492130185","costs_synced":26}
[2025-06-05 22:27:41] DEBUG: Query executed {"sql":"SELECT id, name FROM ads WHERE campaign_id = ?","params":["120224733492130185"],"duration_ms":44.76,"rows_affected":3}
[2025-06-05 22:27:41] DEBUG: Query executed {"sql":"\n    SELECT \n        a.name,\n        fc.date,\n        fc.spend,\n        fc.impressions,\n        fc.clicks\n    FROM ads a\n    JOIN facebook_costs fc ON a.id = fc.entity_id AND fc.entity_type = 'ad'\n    WHERE a.campaign_id = ?\n    ORDER BY fc.date DESC\n    LIMIT 20\n","params":["120224733492130185"],"duration_ms":45.16,"rows_affected":11}
[2025-06-05 22:27:41] DEBUG: Fetching insights {"object_id":"120224733492390185","level":"ad","date_range":{"since":"2025-05-29","until":"2025-06-05"}}
[2025-06-05 22:27:42] INFO: API Call to Facebook {"endpoint":"\/120224733492390185\/insights","params":{"method":"GET","params":{"fields":"spend,impressions,clicks,cpm,cpc,ctr","level":"ad","time_increment":1,"time_range":"{\"since\":\"2025-05-29\",\"until\":\"2025-06-05\"}","access_token":"EAATjAbHDt..."}},"response_code":200,"duration_ms":839.59,"response_size":548}
[2025-06-05 22:29:27] DEBUG: Database connection established 
[2025-06-05 22:29:27] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.89,"rows_affected":1}
[2025-06-05 22:29:27] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":47.73,"rows_affected":3}
[2025-06-05 22:29:31] DEBUG: Database connection established 
[2025-06-05 22:29:31] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.75,"rows_affected":1}
[2025-06-05 22:29:31] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":46.89,"rows_affected":3}
[2025-06-05 22:29:36] DEBUG: Database connection established 
[2025-06-05 22:29:36] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.85,"rows_affected":1}
[2025-06-05 22:29:36] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY) AND fc.date <= CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'last_7_days' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'last_7_days' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.04,"rows_affected":3}
[2025-06-05 22:29:53] DEBUG: Database connection established 
[2025-06-05 22:29:53] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.37,"rows_affected":1}
[2025-06-05 22:29:53] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date >= '2025-06-01' AND fc.date <= '2025-06-08'\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'custom' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'custom' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'custom' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'custom' = 'custom' AND '2025-06-01' != '' THEN '2025-06-01'\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'custom' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'custom' = 'custom' AND '2025-06-08' != '' THEN '2025-06-08'\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'custom' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'custom' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'custom' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'custom' = 'custom' AND '2025-06-01' != '' THEN '2025-06-01'\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'custom' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'custom' = 'custom' AND '2025-06-08' != '' THEN '2025-06-08'\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":46.56,"rows_affected":3}
[2025-06-05 22:31:21] DEBUG: Database connection established 
[2025-06-05 22:31:21] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.76,"rows_affected":1}
[2025-06-05 22:31:21] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":51.73,"rows_affected":3}
[2025-06-05 22:32:05] DEBUG: Database connection established 
[2025-06-05 22:32:05] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.1,"rows_affected":1}
[2025-06-05 22:32:05] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY) AND fc.date <= CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'last_7_days' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'last_7_days' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'last_7_days' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'last_7_days' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":46.67,"rows_affected":3}
[2025-06-05 22:32:19] DEBUG: Database connection established 
[2025-06-05 22:32:19] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":44.42,"rows_affected":1}
[2025-06-05 22:32:20] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.8,"rows_affected":4}
[2025-06-05 22:32:28] DEBUG: Database connection established 
[2025-06-05 22:32:28] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.84,"rows_affected":1}
[2025-06-05 22:32:28] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":47.4,"rows_affected":3}
[2025-06-05 22:37:30] DEBUG: Database connection established 
[2025-06-05 22:37:30] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.89,"rows_affected":1}
[2025-06-05 22:37:30] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":49.98,"rows_affected":3}
[2025-06-05 22:40:12] DEBUG: Database connection established 
[2025-06-05 22:40:12] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":48.04,"rows_affected":8}
[2025-06-05 22:40:12] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":45.31,"rows_affected":1}
[2025-06-05 22:40:12] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":46,"rows_affected":1}
[2025-06-05 22:41:54] DEBUG: Database connection established 
[2025-06-05 22:41:54] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":46.16,"rows_affected":1}
[2025-06-05 22:41:54] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":50.88,"rows_affected":4}
[2025-06-05 22:43:46] DEBUG: Database connection established 
[2025-06-05 22:43:47] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.41,"rows_affected":1}
[2025-06-05 22:43:47] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":46.73,"rows_affected":3}
[2025-06-05 22:43:54] DEBUG: Database connection established 
[2025-06-05 22:43:54] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.83,"rows_affected":1}
[2025-06-05 22:43:54] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.01,"rows_affected":3}
[2025-06-05 22:48:55] DEBUG: Database connection established 
[2025-06-05 22:48:55] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.85,"rows_affected":1}
[2025-06-05 22:48:55] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.06,"rows_affected":3}
[2025-06-05 22:53:57] DEBUG: Database connection established 
[2025-06-05 22:53:57] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.14,"rows_affected":1}
[2025-06-05 22:53:57] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":50.04,"rows_affected":3}
[2025-06-05 22:58:59] DEBUG: Database connection established 
[2025-06-05 22:58:59] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.94,"rows_affected":1}
[2025-06-05 22:58:59] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":47.97,"rows_affected":3}
[2025-06-05 23:10:06] DEBUG: Database connection established 
[2025-06-05 23:10:06] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":50.34,"rows_affected":8}
[2025-06-05 23:10:06] ERROR: Call to undefined method SyncService::getLastSyncStats() {"exception":{"class":"Error","message":"Call to undefined method SyncService::getLastSyncStats()","code":0,"file":"\/var\/www\/html\/savingsnewsnow.com\/apps\/fbtracker\/public\/index.php","line":85,"trace":"#0 {main}"}}
[2025-06-05 23:17:33] DEBUG: Database connection established 
[2025-06-05 23:17:33] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":49.83,"rows_affected":8}
[2025-06-05 23:17:33] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.23,"rows_affected":1}
[2025-06-05 23:17:34] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.45,"rows_affected":1}
[2025-06-05 23:17:42] DEBUG: Database connection established 
[2025-06-05 23:17:42] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":44.52,"rows_affected":1}
[2025-06-05 23:17:42] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":45.72,"rows_affected":4}
[2025-06-05 23:17:49] DEBUG: Database connection established 
[2025-06-05 23:17:50] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.12,"rows_affected":1}
[2025-06-05 23:17:50] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.42,"rows_affected":3}
[2025-06-05 23:17:58] DEBUG: Database connection established 
[2025-06-05 23:17:59] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.09,"rows_affected":1}
[2025-06-05 23:17:59] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":47.51,"rows_affected":3}
[2025-06-05 23:23:00] DEBUG: Database connection established 
[2025-06-05 23:23:00] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.41,"rows_affected":1}
[2025-06-05 23:23:00] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.86,"rows_affected":3}
[2025-06-05 23:28:02] DEBUG: Database connection established 
[2025-06-05 23:28:02] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.84,"rows_affected":1}
[2025-06-05 23:28:02] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'yesterday' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'yesterday' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'yesterday' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":47.66,"rows_affected":3}
[2025-06-05 23:32:44] DEBUG: Database connection established 
[2025-06-05 23:32:44] ERROR: PHP Warning {"message":"include(..\/views\/header.php): failed to open stream: No such file or directory","file":"\/var\/www\/html\/savingsnewsnow.com\/apps\/fbtracker\/public\/index.php","line":66,"type":2}
[2025-06-05 23:36:05] DEBUG: Database connection established 
[2025-06-05 23:36:05] DEBUG: Query executed {"sql":"\n            SELECT * FROM account_summary \n            ORDER BY total_spend_today DESC\n        ","params":[],"duration_ms":50.36,"rows_affected":8}
[2025-06-05 23:36:05] DEBUG: Query executed {"sql":"SELECT * FROM sync_logs \n                WHERE sync_type = ? AND status = 'completed' \n                ORDER BY completed_at DESC \n                LIMIT 1","params":["facebook"],"duration_ms":44.63,"rows_affected":1}
[2025-06-05 23:36:05] DEBUG: Query executed {"sql":"\n            SELECT \n                COUNT(DISTINCT aa.id) as total_accounts,\n                COUNT(DISTINCT c.id) as total_campaigns,\n                COUNT(DISTINCT CASE WHEN c.is_mapped = 1 THEN c.id END) as mapped_campaigns,\n                COALESCE(SUM(fc.spend), 0) as total_spend_today\n            FROM ad_accounts aa\n            LEFT JOIN campaigns c ON aa.id = c.account_id\n            LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                AND fc.entity_type = 'campaign' \n                AND fc.date = CURDATE()\n            WHERE aa.is_active = 1\n        ","params":[],"duration_ms":45.69,"rows_affected":1}
[2025-06-05 23:36:12] DEBUG: Database connection established 
[2025-06-05 23:36:12] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":44.51,"rows_affected":1}
[2025-06-05 23:36:12] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.33,"rows_affected":4}
[2025-06-05 23:36:15] DEBUG: Database connection established 
[2025-06-05 23:36:15] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.6,"rows_affected":1}
[2025-06-05 23:36:15] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.82,"rows_affected":3}
[2025-06-05 23:36:34] DEBUG: Database connection established 
[2025-06-05 23:36:34] DEBUG: Query executed {"sql":"\n                SELECT * FROM ad_accounts WHERE id = ?\n            ","params":["act_1370588717662780"],"duration_ms":44.2,"rows_affected":1}
[2025-06-05 23:36:34] DEBUG: Query executed {"sql":"\n                SELECT \n                    c.*,\n                    fc.spend as spend_today,\n                    fc.impressions as impressions_today,\n                    fc.clicks as clicks_today,\n                    fc.cpm,\n                    fc.cpc,\n                    COALESCE(conv.conversions_today, 0) as conversions_today,\n                    COALESCE(conv.revenue_today, 0) as revenue_today\n                FROM campaigns c\n                LEFT JOIN facebook_costs fc ON c.id = fc.entity_id \n                    AND fc.entity_type = 'campaign' \n                    AND fc.date = CURDATE()\n                LEFT JOIN (\n                    SELECT \n                        campaign_id,\n                        COUNT(*) as conversions_today,\n                        SUM(revenue) as revenue_today\n                    FROM conversions\n                    WHERE DATE(conversion_date) = CURDATE()\n                    GROUP BY campaign_id\n                ) conv ON c.id = conv.campaign_id\n                WHERE c.account_id = ?\n                ORDER BY COALESCE(fc.spend, 0) DESC\n            ","params":["act_1370588717662780"],"duration_ms":46.02,"rows_affected":4}
[2025-06-05 23:36:44] DEBUG: Database connection established 
[2025-06-05 23:36:44] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.13,"rows_affected":1}
[2025-06-05 23:36:44] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":47.19,"rows_affected":3}
[2025-06-05 23:41:45] DEBUG: Database connection established 
[2025-06-05 23:41:45] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.61,"rows_affected":1}
[2025-06-05 23:41:45] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":49.43,"rows_affected":3}
[2025-06-05 23:46:47] DEBUG: Database connection established 
[2025-06-05 23:46:47] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.94,"rows_affected":1}
[2025-06-05 23:46:47] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":48.07,"rows_affected":3}
[2025-06-05 23:51:49] DEBUG: Database connection established 
[2025-06-05 23:51:49] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":45.03,"rows_affected":1}
[2025-06-05 23:51:49] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":49.47,"rows_affected":3}
[2025-06-05 23:56:51] DEBUG: Database connection established 
[2025-06-05 23:56:51] DEBUG: Query executed {"sql":"\n                SELECT c.*, aa.name as account_name, aa.currency\n                FROM campaigns c\n                JOIN ad_accounts aa ON c.account_id = aa.id\n                WHERE c.id = ?\n            ","params":["120224733492130185"],"duration_ms":44.43,"rows_affected":1}
[2025-06-05 23:56:51] DEBUG: Query executed {"sql":"\n                SELECT \n                    a.id,\n                    a.name,\n                    a.status,\n                    ads.name as adset_name,\n                    COALESCE(SUM(fc.spend), 0) as total_spend,\n                    COALESCE(SUM(fc.impressions), 0) as total_impressions,\n                    COALESCE(SUM(fc.clicks), 0) as total_clicks,\n                    CASE \n                        WHEN SUM(fc.impressions) > 0 \n                        THEN (SUM(fc.spend) \/ SUM(fc.impressions)) * 1000 \n                        ELSE 0 \n                    END as cpm,\n                    CASE \n                        WHEN SUM(fc.clicks) > 0 \n                        THEN SUM(fc.spend) \/ SUM(fc.clicks) \n                        ELSE 0 \n                    END as cpc,\n                    COALESCE(COUNT(DISTINCT ch.checkout_id), 0) as checkouts,\n                    COALESCE(COUNT(DISTINCT co.conversion_id), 0) as conversions,\n                    COALESCE(SUM(co.revenue), 0) as revenue\n                FROM ads a\n                JOIN adsets ads ON a.adset_id = ads.id\n                LEFT JOIN facebook_costs fc ON a.id = fc.entity_id \n                    AND fc.entity_type = 'ad' \n                    AND fc.date = CURDATE()\n                LEFT JOIN checkouts ch ON a.id = ch.ad_id \n                    AND DATE(ch.checkout_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(ch.checkout_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                LEFT JOIN conversions co ON a.id = co.ad_id \n                    AND DATE(co.conversion_date) >= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'last_7_days' THEN DATE_SUB(CURDATE(), INTERVAL 7 DAY)\n                            WHEN 'today' = 'last_30_days' THEN DATE_SUB(CURDATE(), INTERVAL 30 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                    AND DATE(co.conversion_date) <= (\n                        CASE \n                            WHEN 'today' = 'yesterday' THEN DATE_SUB(CURDATE(), INTERVAL 1 DAY)\n                            WHEN 'today' = 'custom' AND '' != '' THEN ''\n                            ELSE CURDATE()\n                        END\n                    )\n                WHERE a.campaign_id = ?\n                GROUP BY a.id, a.name, a.status, ads.name\n                ORDER BY COALESCE(SUM(fc.spend), 0) DESC\n            ","params":["120224733492130185"],"duration_ms":45.89,"rows_affected":3}
